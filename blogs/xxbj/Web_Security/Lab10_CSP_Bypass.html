<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.19">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <link rel="icon" href="/favicon.ico"><title>DVWA - CSP Bypass | P-Lab</title><meta name="description" content="boom!">
    <link rel="preload" href="/blog/assets/style-Di8bWRpf.css" as="style"><link rel="stylesheet" href="/blog/assets/style-Di8bWRpf.css">
    <link rel="modulepreload" href="/blog/assets/app-Dh5bFHR3.js"><link rel="modulepreload" href="/blog/assets/Lab10_CSP_Bypass.html-aaPxLW7J.js">
    <link rel="prefetch" href="/blog/assets/timeline.html-BpJqVQ23.js" as="script"><link rel="prefetch" href="/blog/assets/posts.html-CVZnDnIj.js" as="script"><link rel="prefetch" href="/blog/assets/friendship-link.html-BDhggFA8.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Dy1t5pBp.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-SAUOxqao.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DCozlfE9.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Bad53OW_.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DnJ90CbL.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-Dlg2X1ab.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-Zlt_23n0.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-UwZ4rInA.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-Xriu8p1I.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-CXwkHIdM.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-skPDmVOo.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DUm0IX-x.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CSadYAkJ.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BiDYmkho.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-UyTEKEmr.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DITlg3eU.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CB2JiRmm.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-D2q6-Vns.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CHTUa1Ej.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BeWVel8i.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-nnrNBH7o.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-BWb8LG1s.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CKma1_bG.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-frzMZ8FH.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-C4b86oLh.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-DveAsXFS.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CFp963CQ.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-Drat-Y0o.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-BPSItSpc.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-BYdVIW79.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-C9P1MjRy.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-CFOybnje.js" as="script"><link rel="prefetch" href="/blog/assets/7.html-cRNhqFgX.js" as="script"><link rel="prefetch" href="/blog/assets/8.html-B1S9gPgK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CiUsyjqZ.js" as="script"><link rel="prefetch" href="/blog/assets/capk01.html-ggJ9P6OV.js" as="script"><link rel="prefetch" href="/blog/assets/debug01.html-G3xPplZ8.js" as="script"><link rel="prefetch" href="/blog/assets/debug02.html-D_5VE_z9.js" as="script"><link rel="prefetch" href="/blog/assets/debug03.html-BBK-DA1R.js" as="script"><link rel="prefetch" href="/blog/assets/ubuntu_new_network_ada_configtion.html-C77xbLVI.js" as="script"><link rel="prefetch" href="/blog/assets/jszt-1.html-BpJPcgIM.js" as="script"><link rel="prefetch" href="/blog/assets/jszt00.html-fcQxahoe.js" as="script"><link rel="prefetch" href="/blog/assets/jszt01.html-DsGx6Mau.js" as="script"><link rel="prefetch" href="/blog/assets/jszt02.html-DgxWIAoU.js" as="script"><link rel="prefetch" href="/blog/assets/jszt03.html-ZhRPJONT.js" as="script"><link rel="prefetch" href="/blog/assets/jp_vn_dns_check.html-Bm2vEbl3.js" as="script"><link rel="prefetch" href="/blog/assets/2022YiR.html-DKyuMPo0.js" as="script"><link rel="prefetch" href="/blog/assets/2023YiR.html-Cabto_15.js" as="script"><link rel="prefetch" href="/blog/assets/xj000.html-D5xudCqL.js" as="script"><link rel="prefetch" href="/blog/assets/xj001.html-NEhX_C2z.js" as="script"><link rel="prefetch" href="/blog/assets/api.html-DkJHWlpf.js" as="script"><link rel="prefetch" href="/blog/assets/home.html-D_EzJorS.js" as="script"><link rel="prefetch" href="/blog/assets/plugin.html-C23w8IPv.js" as="script"><link rel="prefetch" href="/blog/assets/theme.html-DAGD5rBI.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CnHpvIXB.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-hytUkNzZ.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-hrj7wYJ9.js" as="script"><link rel="prefetch" href="/blog/assets/4.html-AyACjPZ0.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-CU-0X8NY.js" as="script"><link rel="prefetch" href="/blog/assets/7.html-2pXcDAeP.js" as="script"><link rel="prefetch" href="/blog/assets/8.html-l22iOACL.js" as="script"><link rel="prefetch" href="/blog/assets/9.html-C1vdzc7B.js" as="script"><link rel="prefetch" href="/blog/assets/002.html-BCpQRa2w.js" as="script"><link rel="prefetch" href="/blog/assets/test01.html-pZqNazig.js" as="script"><link rel="prefetch" href="/blog/assets/test02.html-AUbrL6oG.js" as="script"><link rel="prefetch" href="/blog/assets/test03.html-C0HW1O_m.js" as="script"><link rel="prefetch" href="/blog/assets/test04.html-B6glHKqW.js" as="script"><link rel="prefetch" href="/blog/assets/test05.html-DaMFk1Wk.js" as="script"><link rel="prefetch" href="/blog/assets/test06.html-CIGXVo6F.js" as="script"><link rel="prefetch" href="/blog/assets/test07.html-CCviLeQS.js" as="script"><link rel="prefetch" href="/blog/assets/test08.html-BlF9Ne-b.js" as="script"><link rel="prefetch" href="/blog/assets/test09.html-CMjp-vQg.js" as="script"><link rel="prefetch" href="/blog/assets/test10.html-DIMeUny0.js" as="script"><link rel="prefetch" href="/blog/assets/test11.html-CWwiewQK.js" as="script"><link rel="prefetch" href="/blog/assets/test12.html-WDviix5r.js" as="script"><link rel="prefetch" href="/blog/assets/test13.html-DYNAvM7S.js" as="script"><link rel="prefetch" href="/blog/assets/test14.html-BvsLuY6m.js" as="script"><link rel="prefetch" href="/blog/assets/2_GFS.html-UZEnyGST.js" as="script"><link rel="prefetch" href="/blog/assets/5_Hadoop.html-DoewUK_x.js" as="script"><link rel="prefetch" href="/blog/assets/lab2.html-7CLamck5.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj1.html-CGmZOdTE.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj2.html-D7ewMyZ9.js" as="script"><link rel="prefetch" href="/blog/assets/xxbj3.html-kWD7ikUI.js" as="script"><link rel="prefetch" href="/blog/assets/1_Basic.html-v3l0CwPU.js" as="script"><link rel="prefetch" href="/blog/assets/2_Nmap.html-DJaLI57t.js" as="script"><link rel="prefetch" href="/blog/assets/st0.html-Y5UUsDUE.js" as="script"><link rel="prefetch" href="/blog/assets/st1.html-CQXAhpTC.js" as="script"><link rel="prefetch" href="/blog/assets/st2.html-CiZNM1xY.js" as="script"><link rel="prefetch" href="/blog/assets/1.html-CMxZQwSx.js" as="script"><link rel="prefetch" href="/blog/assets/2.html-jJr_2h3z.js" as="script"><link rel="prefetch" href="/blog/assets/3.html-B3VM1gxa.js" as="script"><link rel="prefetch" href="/blog/assets/5.html-BJLOA3st.js" as="script"><link rel="prefetch" href="/blog/assets/6.html-C-8QxIhc.js" as="script"><link rel="prefetch" href="/blog/assets/1_Vue_Getstart.html-Bq3ZlTS-.js" as="script"><link rel="prefetch" href="/blog/assets/2_Vue_Commands.html-ywlin1Gz.js" as="script"><link rel="prefetch" href="/blog/assets/3_Vue_Component.html-Bd-Nkjxq.js" as="script"><link rel="prefetch" href="/blog/assets/4_Vue_Slot.html-Bm0_Fmg_.js" as="script"><link rel="prefetch" href="/blog/assets/5_Vue_CLI.html-BH698BxJ.js" as="script"><link rel="prefetch" href="/blog/assets/6_Vue_Router.html-B_Iyli9V.js" as="script"><link rel="prefetch" href="/blog/assets/7_Vue_Vuex.html-CZxmmdG9.js" as="script"><link rel="prefetch" href="/blog/assets/Lab11_JavaScript.html-CTB5E4AE.js" as="script"><link rel="prefetch" href="/blog/assets/Lab1_Brute_Force.html-BUFLSaSy.js" as="script"><link rel="prefetch" href="/blog/assets/Lab2_Command_Injection.html-D9blD3gH.js" as="script"><link rel="prefetch" href="/blog/assets/Lab3_CSRF.html-D6zzDCg9.js" as="script"><link rel="prefetch" href="/blog/assets/Lab4_File_Inclusion.html-CCihZNrY.js" as="script"><link rel="prefetch" href="/blog/assets/Lab5_FileUpload.html-BEYAhM9b.js" as="script"><link rel="prefetch" href="/blog/assets/Lab6_Insecure_CAPTCHA.html-Dh0pkH0E.js" as="script"><link rel="prefetch" href="/blog/assets/Lab7_SQL_Injection.html-B3EjceKM.js" as="script"><link rel="prefetch" href="/blog/assets/Lab8_Weak_Session_IDs.html-CMK6TLWB.js" as="script"><link rel="prefetch" href="/blog/assets/Lab9_XSS.html-oz9MHCfw.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-LwC5kAsb.js" as="script"><link rel="prefetch" href="/blog/assets/Valine.min-_LyT3bfY.js" as="script"><link rel="prefetch" href="/blog/assets/giscus-aTimukGI-DWEKOTfS.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container series--no show-catalog"><header class="navbar-container not-open"><div class="navbar-inner"><div class="site-brand nav-item"><img class="logo" src="/blog/logo.jpg" alt="P-Lab"><a href="/blog/" class="site-name can-hide">P-Lab</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/blog/" class="link" aria-label="主页"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->主页<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/blog/categories/jishuzatan/1.html" class="link" aria-label="分类"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->分类<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/blog/tags/Debug/1.html" class="link" aria-label="标签"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->标签<!--]--></span></span><!--[--><!--]--></a></div><!--]--><!----><span class="xicon-container btn-toggle-dark-mode btn--dark-mode navbar-links__item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><ul class="social-links navbar-links__item"><!--[--><li class="social-item"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:25px;height:25px;"><path d="M16 2a14 14 0 0 0-4.43 27.28c.7.13 1-.3 1-.67v-2.38c-3.89.84-4.71-1.88-4.71-1.88a3.71 3.71 0 0 0-1.62-2.05c-1.27-.86.1-.85.1-.85a2.94 2.94 0 0 1 2.14 1.45a3 3 0 0 0 4.08 1.16a2.93 2.93 0 0 1 .88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4 5.4 0 0 1 1.44-3.76a5 5 0 0 1 .14-3.7s1.17-.38 3.85 1.43a13.3 13.3 0 0 1 7 0c2.67-1.81 3.84-1.43 3.84-1.43a5 5 0 0 1 .14 3.7a5.4 5.4 0 0 1 1.44 3.76c0 5.38-3.27 6.56-6.39 6.91a3.33 3.33 0 0 1 .95 2.59v3.84c0 .46.25.81 1 .67A14 14 0 0 0 16 2z" fill-rule="evenodd" fill="currentColor"></path></svg></li><!--]--></ul></nav><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></div></header><!----><!----><!----><div class="theme-main" style=""><!----><!--[--><main class="page-container"><div class="page-content"><h1 class="page-title">DVWA - CSP Bypass</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->PPPerryPan<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->2022-08-28<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog/categories/xuexibiji/1.html" class="">学习笔记</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[--><!--[--><a href="/blog/tags/wangluoanquan/1.html" class="">网络安全</a><!--]--><!--]--></span></span><!----></div><div class="theme-reco-md-content"><div><h2 id="low" tabindex="-1"><a class="header-anchor" href="#low"><span>Low</span></a></h2><h3 id="源代码" tabindex="-1"><a class="header-anchor" href="#源代码"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token variable">$headerCSP</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Content-Security-Policy: script-src &#39;self&#39; https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;&quot;</span><span class="token punctuation">;</span> <span class="token comment">// allows js from self, pastebin.com, hastebin.com, jquery and google analytics.</span></span>
<span class="line"></span>
<span class="line"><span class="token function">header</span><span class="token punctuation">(</span><span class="token variable">$headerCSP</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># These might work if you can&#39;t create your own for some reason</span></span>
<span class="line"><span class="token comment"># https://pastebin.com/raw/R570EE00</span></span>
<span class="line"><span class="token comment"># https://www.toptal.com/developers/hastebin/raw/cezaruzeka</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">    &lt;script src=&#39;&quot;</span> <span class="token operator">.</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;&#39;&gt;&lt;/script&gt;</span>
<span class="line">&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">&#39;</span>
<span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span>
<span class="line">    &lt;p&gt;You can include scripts from external sources, examine the Content Security Policy and enter a URL to include here:&lt;/p&gt;</span>
<span class="line">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span>
<span class="line">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span>
<span class="line">&lt;/form&gt;</span>
<span class="line">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析" tabindex="-1"><a class="header-anchor" href="#代码分析"><span>代码分析</span></a></h3><p>对 HTTP 头定义了 CSP 标签，从而定义了可以接受外部 JavaScript 资源的白名单</p><blockquote><p>https://pastebin.com</p><p>hastebin.com</p><p>www.toptal.com</p><p>example.com</p><p>code.jquery.com</p><p>https://ssl.google-analytics.com</p></blockquote><h3 id="漏洞利用" tabindex="-1"><a class="header-anchor" href="#漏洞利用"><span>漏洞利用</span></a></h3><p>打开 https://pastebin.com 看看，发现是个分享文本内容的网站；</p><p>尝试在文本内容中嵌入一段 JS 代码</p><p><img src="/blog/assets/image-20220828221920057-CxJ0R_dG.png" alt="image-20220828221920057"></p><p><img src="/blog/assets/image-20220828221942381-BjVPPRvW.png" alt="image-20220828221942381"></p><p><img src="/blog/assets/image-20220828222008135-BHg0Dwug.png" alt="image-20220828222008135"></p><p>返回DVWA 粘贴并包含，即可弹窗</p><p><img src="/blog/assets/image-20220828223543277-4V6ajPMG.png" alt="image-20220828223543277"></p><p>注：可见其返回200，但是他不弹窗啊！！</p><p><img src="/blog/assets/image-20220828223626428-ZrF3oiGm.png" alt="image-20220828223626428"></p><p>看了下机场的航班发送日志，他上了飞往 HK 的航班，但一样不弹。<s>（不会吧不会吧 有人连某些地方说的网络环境问题都信）</s></p><p>然后去看了眼 Console，</p><p>有意思 JS 被拒绝了！</p><p><img src="/blog/assets/image-20220828224345108-D3IpqL_c.png" alt="image-20220828224345108"></p><p>那直接换个网站吧。。</p><p>来白名单里的另一个 <a href="hastebin.com">链接</a> 创一个，然后保存，切换到仅文本</p><blockquote><p>PS：各位检票员请记得让他上飞机。</p></blockquote><p><img src="/blog/assets/image-20220828224026964-ao7XzpOb.png" alt="image-20220828224026964"></p><p>拿链接：https://hastebin.com/raw/uxuritazur</p><p><img src="/blog/assets/image-20220828224046299-DTrlu8y5.png" alt="image-20220828224046299"></p><p>粘贴到 DVWA 并 include，搞定</p><blockquote><p>PS：各位检票员请记得让他上飞机。</p></blockquote><p><img src="/blog/assets/image-20220828224217665-BQJ5sYej.png" alt="image-20220828224217665"></p><h2 id="medium" tabindex="-1"><a class="header-anchor" href="#medium"><span>Medium</span></a></h2><h3 id="源代码-1" tabindex="-1"><a class="header-anchor" href="#源代码-1"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token variable">$headerCSP</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Content-Security-Policy: script-src &#39;self&#39; &#39;unsafe-inline&#39; &#39;nonce-TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">header</span><span class="token punctuation">(</span><span class="token variable">$headerCSP</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Disable XSS protections so that inline alert boxes will work</span></span>
<span class="line"><span class="token function">header</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;X-XSS-Protection: 0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># &lt;script nonce=&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;&gt;alert(1)&lt;/script&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">    &quot;</span> <span class="token operator">.</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">&#39;</span>
<span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span>
<span class="line">    &lt;p&gt;Whatever you enter here gets dropped directly into the page, see if you can get an alert box to pop up.&lt;/p&gt;</span>
<span class="line">    &lt;input size=&quot;50&quot; type=&quot;text&quot; name=&quot;include&quot; value=&quot;&quot; id=&quot;include&quot; /&gt;</span>
<span class="line">    &lt;input type=&quot;submit&quot; value=&quot;Include&quot; /&gt;</span>
<span class="line">&lt;/form&gt;</span>
<span class="line">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-1" tabindex="-1"><a class="header-anchor" href="#代码分析-1"><span>代码分析</span></a></h3><p>源码中nonce参数无任何过滤，注入时直接令 nonce 为设定好的值即可。</p><h3 id="漏洞利用-1" tabindex="-1"><a class="header-anchor" href="#漏洞利用-1"><span>漏洞利用</span></a></h3><p>源码里注释居然就有一个，试一下，成功：</p><p><img src="/blog/assets/image-20220828225356899-CYUjThvI.png" alt="image-20220828225356899"></p><p>试一下改改内容，成功</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">nonce</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;TEST&#39;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220828225525593-ptQxbSN8.png" alt="image-20220828225525593"></p><h2 id="high" tabindex="-1"><a class="header-anchor" href="#high"><span>High</span></a></h2><h3 id="源代码-2" tabindex="-1"><a class="header-anchor" href="#源代码-2"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token variable">$headerCSP</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Content-Security-Policy: script-src &#39;self&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">header</span><span class="token punctuation">(</span><span class="token variable">$headerCSP</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">    &quot;</span> <span class="token operator">.</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">&#39;</span>
<span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span>
<span class="line">    &lt;p&gt;The page makes a call to &#39;</span> <span class="token operator">.</span> <span class="token constant">DVWA_WEB_PAGE_TO_ROOT</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&#39;/vulnerabilities/csp/source/jsonp.php to load some code. Modify that page to run your own code.&lt;/p&gt;</span>
<span class="line">    &lt;p&gt;1+2+3+4+5=&lt;span id=&quot;answer&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span>
<span class="line">    &lt;input type=&quot;button&quot; id=&quot;solve&quot; value=&quot;Solve the sum&quot; /&gt;</span>
<span class="line">&lt;/form&gt;</span>
<span class="line"></span>
<span class="line">&lt;script src=&quot;source/high.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token comment">// high.js</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">clickButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> s <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    s<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;source/jsonp.php?callback=solveSum&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">solveSum</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;answer&quot;</span> <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;answer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">&#39;answer&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> solve_button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span> <span class="token punctuation">(</span><span class="token string">&quot;solve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>solve_button<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">	solve_button<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">		<span class="token function">clickButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-2" tabindex="-1"><a class="header-anchor" href="#代码分析-2"><span>代码分析</span></a></h3><p>这个级别没有输入框了。</p><p>先看一下 CSP 头, 发现只有 <code>script-src &#39;self&#39;;</code>，只允许本界面加载的 javascript 执行。</p><p>然后研究了一下这个点击显示答案的逻辑 (逻辑在 <code>source/high.js</code>里），</p><p>大致如下:</p><ol><li>点击按钮</li><li>js 生成一个 script 标签 (src 指向 source/jsonp.php?callback=solveNum) , 并把它加入到 DOM 中</li><li>js 中定义了一个 solveNum 的函数</li><li>script 标签会把远程加载的 <code>solveSum({&quot;answer&quot;:&quot;15&quot;})</code> 当作 js 代码执行</li></ol><h3 id="漏洞利用-2" tabindex="-1"><a class="header-anchor" href="#漏洞利用-2"><span>漏洞利用</span></a></h3><p>看着好像 除了改JS没什么头绪，那看看jsonp.php那？好像没有任何过滤，试试用 HackBar include 一下，成了</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line">include=<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>source/jsonp.php?callback=alert(&#39;TEST&#39;);<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="/blog/assets/image-20220828231244497-YGTrj-jF.png" alt="image-20220828231244497"></p><h2 id="impossible" tabindex="-1"><a class="header-anchor" href="#impossible"><span>Impossible</span></a></h2><h3 id="源代码-3" tabindex="-1"><a class="header-anchor" href="#源代码-3"><span>源代码</span></a></h3><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php" data-title="php"><pre><code><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"></span>
<span class="line"><span class="token variable">$headerCSP</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Content-Security-Policy: script-src &#39;self&#39;;&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">header</span><span class="token punctuation">(</span><span class="token variable">$headerCSP</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">    &quot;</span> <span class="token operator">.</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;include&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;</span>
<span class="line">&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token variable">$page</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">&#39;body&#39;</span> <span class="token punctuation">]</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">&#39;</span>
<span class="line">&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt;</span>
<span class="line">    &lt;p&gt;Unlike the high level, this does a JSONP call but does not use a callback, instead it hardcodes the function to call.&lt;/p&gt;&lt;p&gt;The CSP settings only allow external JavaScript on the local server and no inline code.&lt;/p&gt;</span>
<span class="line">    &lt;p&gt;1+2+3+4+5=&lt;span id=&quot;answer&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span>
<span class="line">    &lt;input type=&quot;button&quot; id=&quot;solve&quot; value=&quot;Solve the sum&quot; /&gt;</span>
<span class="line">&lt;/form&gt;</span>
<span class="line"></span>
<span class="line">&lt;script src=&quot;source/impossible.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">vulnerabilities<span class="token operator">/</span>csp<span class="token operator">/</span>source<span class="token operator">/</span>impossible<span class="token operator">.</span>js</span>
<span class="line"><span class="token keyword">function</span> <span class="token function-definition function">clickButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> s <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    s<span class="token operator">.</span>src <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;source/jsonp_impossible.php&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    document<span class="token operator">.</span>body<span class="token operator">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function-definition function">solveSum</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;answer&quot;</span> in obj<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        document<span class="token operator">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;answer&quot;</span><span class="token punctuation">)</span><span class="token operator">.</span>innerHTML <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;answer&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> solve_button <span class="token operator">=</span> document<span class="token operator">.</span><span class="token function">getElementById</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;solve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>solve_button<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    solve_button<span class="token operator">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">clickButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码分析-3" tabindex="-1"><a class="header-anchor" href="#代码分析-3"><span>代码分析</span></a></h3><p>修复了 callback 参数可被控制问题，从根源杜绝了Bug。</p><p>对比：</p><blockquote><p>high level：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">s<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;source/jsonp.php?callback=solveSum&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>impossible level：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">s<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;source/jsonp_impossible.php&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></blockquote></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Last Updated 2025/5/25 15:00:04<!--]--></span></span></div></footer><!----><!----></div><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#low" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Low"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Low<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#源代码" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#代码分析" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#漏洞利用" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#medium" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Medium"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Medium<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#源代码-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#代码分析-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#漏洞利用-1" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#high" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="High"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->High<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#源代码-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#代码分析-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#漏洞利用-2" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="漏洞利用"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->漏洞利用<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#impossible" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="Impossible"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->Impossible<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#源代码-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="源代码"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->源代码<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blog/blogs/xxbj/Web_Security/Lab10_CSP_Bypass.html#代码分析-3" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="代码分析"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:;font-size:14px;"><!--[-->代码分析<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></main><!--]--></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/blog/assets/app-Dh5bFHR3.js" defer></script>
  </body>
</html>
