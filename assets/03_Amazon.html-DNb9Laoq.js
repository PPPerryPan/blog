import{_ as l,c as n,b as t,o as i}from"./app-CUDFWA7u.js";const s="/blog/assets/image-20220314133844964-BGrV5Zs6.png",e="/blog/assets/image-20220314142915606-Cuu49nFW.png",r="/blog/assets/image-20220314143303701-1GuT26pT.png",o="/blog/assets/image-20220314143330421-D0V_sQJ7.png",p="/blog/assets/image-20220314153134497-BnXr3HjG.png",g="/blog/assets/image-20220314234753810-DKOqU6j9.png",c="/blog/assets/image-20220314234833530-4hULXUV0.png",h="/blog/assets/image-20220314235622276-COfoCjl2.png",d="/blog/assets/image-20220314235722395-BohZnY1r.png",m="/blog/assets/image-20220314235808920-BsAkyjfD.png",u="/blog/assets/image-20220315000205498-CSwUc1Ja.png",_="/blog/assets/image-20220315000329665-CBWTVE0h.png",y="/blog/assets/image-20220315011428214-F7pdZ-2u.png",b="/blog/assets/image-20220315011657037-B0Wyh1YY.png",x="/blog/assets/image-20220315011755340-CjdPwCFU.png",f={};function A(C,a){return i(),n("div",null,a[0]||(a[0]=[t('<p><strong>Amazon 提供的服务</strong></p><ul><li><p>弹性计算云EC2</p></li><li><p>简单存储服务S3</p></li><li><p>简单数据库服务Simple DB</p></li><li><p>简单队列服务SQS</p></li><li><p>弹性MapReduce服务</p></li><li><p>内容推送服务CloudFront</p></li><li><p>电子商务服务DevPay</p></li><li><p>FPS</p></li></ul><h2 id="_3-1-基础存储架构dynamo" tabindex="-1"><a class="header-anchor" href="#_3-1-基础存储架构dynamo"><span>3.1 基础存储架构Dynamo</span></a></h2><h3 id="_3-1-1-dynamo概况" tabindex="-1"><a class="header-anchor" href="#_3-1-1-dynamo概况"><span>3.1.1 Dynamo概况</span></a></h3><ul><li><p>采用完全的分布式、去中心化的架构</p><ul><li>存储节点呈无中心的环状分布。</li></ul></li><li><p>作为底层存储架构的Dynamo也同样采用了无中心的模式</p></li><li><p>Dynamo只支持简单的键/值（key/value）方式的数据存储，不支持复杂的查询</p></li><li><p>Dynamo中存储的是数据值的原始形式，即按位存储，并不解析数据的具体内容</p></li></ul><p><img src="'+s+'" alt="面向服务的Amazon平台架构"></p><ul><li>Dynamo需要解决的主要问题及解决方案</li></ul><table><thead><tr><th style="text-align:center;">问题</th><th style="text-align:center;">采取的相关技术</th></tr></thead><tbody><tr><td style="text-align:center;">数据均衡分布</td><td style="text-align:center;">改进的一致性哈希算法</td></tr><tr><td style="text-align:center;">数据备份</td><td style="text-align:center;">参数可调的弱 quorum 机制</td></tr><tr><td style="text-align:center;">数据冲突处理</td><td style="text-align:center;">向量时钟（Vector Clock）</td></tr><tr><td style="text-align:center;">成员资格及错误检测</td><td style="text-align:center;">基于 Gossip 协议的成员资格和错误检测</td></tr><tr><td style="text-align:center;">临时故障处理</td><td style="text-align:center;">Hinted handoff （数据回传机制）</td></tr><tr><td style="text-align:center;">永久故障处理</td><td style="text-align:center;">Merkle 哈系数</td></tr></tbody></table><h4 id="数据均衡分布的问题" tabindex="-1"><a class="header-anchor" href="#数据均衡分布的问题"><span>数据均衡分布的问题</span></a></h4><ul><li><p>Dynamo采用了分布式的数据存储架构，均衡的数据分布可以保证负载平衡和系统良好的扩展性。</p></li><li><p>Dynamo中使用<strong>改进后的一致性哈希算法</strong>，并在此基础上进行数据备份，以提高系统的可用性。</p><ul><li><p>一致性哈希算法除了能够保证哈希运算结果充分分散到整个环上外，还能保证在添加或删除设备节点时只会影响到其在哈希环中的前驱设备节点，而不会对其他设备节点产生影响。</p></li><li><p>一致性哈希算法可以<strong>大大降低</strong>在添加或删除节点时引起的<strong>节点间的数据传输开销</strong></p><p><img src="'+e+'" alt="image-20220314142915606"></p></li></ul></li></ul><h5 id="改进的一致性哈希算法" tabindex="-1"><a class="header-anchor" href="#改进的一致性哈希算法"><span>改进的一致性哈希算法</span></a></h5><ul><li>每个虚拟节点都隶属于某一个实际的物理节点，一个物理节点根据其性能的差异被分为一个或多个虚拟节点。</li><li>各个虚拟节点的能力基本相当，并随机分布在哈希环上。</li></ul><p><img src="'+r+'" alt="image-20220314143303701"></p><ul><li><p>在存储数据时，每个数据会被先分配到某个数据分区，再根据负责该数据分区的虚拟节点，最终确定其所存储的物理节点。</p><p><img src="'+o+'" alt="image-20220314143330421"></p></li><li><p>数据分区的好处</p><ul><li><p>减小数据分布不均衡的可能性</p></li><li><p>添加或删除设备节点时引起较小的数据传输</p></li></ul></li></ul><h4 id="数据备份" tabindex="-1"><a class="header-anchor" href="#数据备份"><span>数据备份</span></a></h4><ul><li><p>在Dynamo中，每个数据的副本备份存储在哈希环顺时针方向上该数据所在虚拟节点的后继节点中。</p></li><li><p>数据备份在存储数据的同时进行，会使每次写操作的延时变长。</p></li><li><p>Dynamo中对写操作进行了优化，保证一个副本必须写入硬盘，其他副本只要写入节点的内存即返回写成功。</p></li><li><p>每个虚拟节点上实际存储了分配给它以及分配它的前N-1个前驱虚拟节点的数据。</p></li></ul><h4 id="数据冲突问题" tabindex="-1"><a class="header-anchor" href="#数据冲突问题"><span>数据冲突问题</span></a></h4><ul><li><p>分布式系统架构中通常考虑的三个因素</p><ul><li>可靠性</li><li>可用性</li><li>一致性</li></ul></li><li><p>Dynamo选择通过<strong>牺牲一致性</strong>来保证系统的可靠性和可用性，没有采用强一致性模型而<strong>采用了最终一致性模型</strong>。</p></li><li><p>采用<strong>向量时钟技术</strong></p></li><li><p>Dynamo中的向量时钟通过<code>[node, counter] 对</code> 来表示。</p><ul><li><strong>node</strong>表示<strong>操作节点</strong></li><li>counter<strong>是其</strong>对应的计数器**，<strong>初始值为</strong> <strong>0</strong>节点每进行一次更新操作则<strong>计数器****加</strong> <strong>1</strong></li></ul></li></ul><p><img src="'+p+'" alt="image-20220314153134497"></p><h4 id="成员资格及错误检测" tabindex="-1"><a class="header-anchor" href="#成员资格及错误检测"><span>成员资格及错误检测</span></a></h4><ul><li><p>由于Dynamo采用了无中心的架构，每个成员节点都需要保存其他节点的路由信息</p></li><li><p>为了保证每个节点都能拥有最新的成员节点信息，Dynamo中采用了一种类似于Gossip（闲聊）协议的技术</p></li></ul><p><img src="'+g+'" alt="image-20220314234753810"></p><ul><li><p>Dynamo中还通过Gossip来实现错误检测任何节点向其他节点发起通信后，如果对方没有回应，则认为对方节点失效</p></li><li><p>为了避免新加入的节点之间不能及时发现其他节点的存在，Dynamo中设置了一些种子节点（Seed Node）。种子节点和所有的节点都有联系。当新节点加入时，它扮演一个中介的角色，使新加入节点之间互相感知。</p></li></ul><p><img src="'+c+'" alt="image-20220314234833530"></p><h4 id="容错机制" tabindex="-1"><a class="header-anchor" href="#容错机制"><span>容错机制</span></a></h4><h5 id="临时故障处理机制" tabindex="-1"><a class="header-anchor" href="#临时故障处理机制"><span>临时故障处理机制</span></a></h5><ul><li><p>为了处理临时失效的节点，Dynamo中采用了一种带有监听的数据回传机制（Hinted Handoff）</p></li><li><p>当虚拟节点A失效后，会将数据临时存放在节点D的临时空间中，并在节点A重新可用后，由节点D将数据回传给节点A。</p></li></ul><p><img src="'+h+'" alt="image-20220314235622276"></p><h5 id="永久性故障处理机制" tabindex="-1"><a class="header-anchor" href="#永久性故障处理机制"><span>永久性故障处理机制</span></a></h5><ul><li>Dynamo采用<strong>Merkle哈希树</strong>技术来加快检测和减少数据传输量</li></ul><p><img src="'+d+'" alt="image-20220314235722395"></p><h2 id="_3-2-弹性计算云ec2" tabindex="-1"><a class="header-anchor" href="#_3-2-弹性计算云ec2"><span>3.2 弹性计算云EC2</span></a></h2><h3 id="_3-2-1-ec2的基本架构" tabindex="-1"><a class="header-anchor" href="#_3-2-1-ec2的基本架构"><span>3.2.1 EC2的基本架构</span></a></h3><ul><li>主要包括了Amazon机器映象、实例、存储模块等组成部分，并能与S3等其他Amazon云计算服务结合使用。</li></ul><p><img src="'+m+'" alt="image-20220314235808920"></p><h5 id="amazon机器映象-ami" tabindex="-1"><a class="header-anchor" href="#amazon机器映象-ami"><span>Amazon机器映象（AMI）</span></a></h5><ul><li><p>Amazon机器映像（Amazon Machine Image，AMI）是包含了操作系统、服务器程序、应用程序等软件配置的模板</p></li><li><p>四种获取AMI的途径</p><ul><li>免费使用Amazon提供的公共AMI</li><li>根据自身需要定制一个或多个私有AMI</li><li>向开发者付费购买AMI</li><li>使用其他开发者分享的共享AMI</li></ul></li><li><p>构建好的AMI分为Amaznon EBS支持和实例存储支持两类</p></li></ul><h5 id="实例-instance" tabindex="-1"><a class="header-anchor" href="#实例-instance"><span>实例（Instance）</span></a></h5><p>EC2中实例由<strong>AMI启动</strong>，可以像传统的主机一样提供服务。同一个AMI可以用于创建具有<strong>不同计算和存储能力的实例</strong>。 Amazon提供了多种不同类型的实例，分别<strong>在计算、GPU、内存、存储、网络、费用</strong>等方面进行了优化 Amazon还允许用户在应用程序的需求发生变更时，对<strong>实例的类型进行调整</strong>，从而实现按需付费。 Amazon EC2还为实例提供了许多<strong>附加功能</strong>，帮助用户更好地<strong>部署和管理应用程序</strong>。</p><h5 id="弹性块存储-ebs" tabindex="-1"><a class="header-anchor" href="#弹性块存储-ebs"><span>弹性块存储（EBS）</span></a></h5><p><img src="'+u+'" alt="image-20220315000205498"></p><p>EBS存储卷的设计与<strong>物理硬盘相似</strong>，其大小由用户设定，目前提供的容量从<strong>1GB到1TB</strong>不等。</p><p>EBS存储卷适用于数据需要<strong>细粒度</strong>地频繁访问并持久保存的情形，适合作为文件系统或数据库的<strong>主存储</strong>。</p><p><strong>快照功能</strong>是EBS的特色功能之一，用于在S3中存储Amazon EBS卷的时间点副本。</p><h3 id="_3-2-2-ec2的关键技术" tabindex="-1"><a class="header-anchor" href="#_3-2-2-ec2的关键技术"><span>3.2.2 EC2的关键技术</span></a></h3><h4 id="地理区域和可用区域" tabindex="-1"><a class="header-anchor" href="#地理区域和可用区域"><span>地理区域和可用区域</span></a></h4><ul><li><p>地理区域</p></li><li><p>可用区域</p><ul><li><p>是否有独立的供电系统和冷却系统等</p></li><li><p>通常将每个数据中心看做一个可用区域</p></li></ul></li><li><p>EC2系统中包含多个地理区域，而每个地理区域中又包含多个可用区域。为了确保系统的稳定性，用户最好将自己的多个实例分布在不同的可用区域和地理区域中。</p></li></ul><p><img src="'+_+'" alt="image-20220315000329665"></p><h4 id="ec2的通信机制" tabindex="-1"><a class="header-anchor" href="#ec2的通信机制"><span>EC2的通信机制</span></a></h4><p><img src="'+y+'" alt="image-20220315011428214"></p><h4 id="弹性负载平衡" tabindex="-1"><a class="header-anchor" href="#弹性负载平衡"><span>弹性负载平衡</span></a></h4><h4 id="监控服务" tabindex="-1"><a class="header-anchor" href="#监控服务"><span>监控服务</span></a></h4><ul><li>AWS资源的可视化检测功能 <ul><li>EC2实例状态</li><li>资源利用率</li><li>需求状况</li><li>CPU利用率</li><li>磁盘读取</li><li>写入</li><li>网络流量</li></ul></li></ul><p>用户只需要选择EC2实例，设定监视时间，CloudWatch就可以自动收集和存储检测数据</p><h4 id="自动缩放" tabindex="-1"><a class="header-anchor" href="#自动缩放"><span>自动缩放</span></a></h4><p>自动缩放可以按照用户自定义的条件，自动调整EC2的计算能力：</p><ul><li>需求高峰期 <ul><li>确保EC2实例的处理能力无缝增大</li></ul></li><li>需求下降时 <ul><li>自动缩小EC2实例规模以降低成本</li></ul></li></ul><p>自动缩放功能特别适合<strong>周期性变化</strong>的应用程序，它由<strong>CloudWatch</strong>自动启动。</p><h4 id="服务管理控制台" tabindex="-1"><a class="header-anchor" href="#服务管理控制台"><span>服务管理控制台</span></a></h4><p>各项技术通过互相配合来实现EC2的可扩展性和可靠性</p><p><img src="'+b+'" alt="image-20220315011657037"></p><h3 id="_3-2-3-ec2的安全及容错机制" tabindex="-1"><a class="header-anchor" href="#_3-2-3-ec2的安全及容错机制"><span>3.2.3 EC2的安全及容错机制</span></a></h3><ul><li><p>安全组是一组规则，用户利用这些规则来决定哪些<strong>网络流量会被实例接受</strong>，其他则全部拒绝。</p></li><li><p>当用户的实例被创建时，如果没有指定<strong>安全组</strong>，则系统自动将该实例分配给一个<strong>默认组</strong>。</p></li><li><p>默认组只接受<strong>组内成员的消息</strong>，拒绝其他消息。</p></li><li><p>当一个组的<strong>规则改变</strong>后，改变的规则自动<strong>适用</strong>于组中所有的成员。</p></li><li><p>SSH是目前对网络上传输的数据进行加密的一种很可靠的协议，当用户创建一个<strong>密钥对</strong>时，<strong>密钥对的名称</strong>（Key Pair Name）和<strong>公钥</strong>（Public Key）会被<strong>存储</strong>在EC2中</p><p><img src="'+x+'" alt="image-20220315011755340"></p></li></ul><h4 id="ec2引入了弹性ip地址的概念" tabindex="-1"><a class="header-anchor" href="#ec2引入了弹性ip地址的概念"><span>EC2引入了弹性IP地址的概念</span></a></h4><ul><li>弹性IP地址和<strong>用户账号绑定</strong>而不是和某个特定的实例绑定</li><li>当系统正在使用的实例出现故障时，用户只需要将弹性IP地址通过网络地址转换<strong>NAT</strong>转换为新实例所对应的<strong>私有IP地址</strong></li><li>通过弹性IP地址改变映射关系总可以<strong>保证有实例可用</strong></li></ul>',65)]))}const D=l(f,[["render",A]]),S=JSON.parse('{"path":"/blogs/tech/cloud/03_Amazon.html","title":"Amazon 云服务分类","lang":"en-US","frontmatter":{"title":"Amazon 云服务分类","date":"2022-03-07T00:00:00.000Z","tags":["Cloud"],"categories":["tech"]},"headers":[{"level":2,"title":"3.1 基础存储架构Dynamo","slug":"_3-1-基础存储架构dynamo","link":"#_3-1-基础存储架构dynamo","children":[{"level":3,"title":"3.1.1 Dynamo概况","slug":"_3-1-1-dynamo概况","link":"#_3-1-1-dynamo概况","children":[]}]},{"level":2,"title":"3.2 弹性计算云EC2","slug":"_3-2-弹性计算云ec2","link":"#_3-2-弹性计算云ec2","children":[{"level":3,"title":"3.2.1  EC2的基本架构","slug":"_3-2-1-ec2的基本架构","link":"#_3-2-1-ec2的基本架构","children":[]},{"level":3,"title":"3.2.2  EC2的关键技术","slug":"_3-2-2-ec2的关键技术","link":"#_3-2-2-ec2的关键技术","children":[]},{"level":3,"title":"3.2.3  EC2的安全及容错机制","slug":"_3-2-3-ec2的安全及容错机制","link":"#_3-2-3-ec2的安全及容错机制","children":[]}]}],"git":{"createdTime":1766826955000,"updatedTime":1766890838000,"contributors":[{"name":"PPPerryPan","email":"perrypan0123@outlook.com","commits":2}]},"filePathRelative":"blogs/tech/cloud/03_Amazon.md"}');export{D as comp,S as data};
