import{_ as s,c as a,b as e,o as p}from"./app-CUDFWA7u.js";const i="/blog/assets/image-20220530151604470-DVmYFVjQ.png",t="/blog/assets/image-20220530151806406-DeV9aC_n.png",l="/blog/assets/image-20220606143533388-DzhK4HId.png",c="/blog/assets/image-20220606150311428-BtevzeQQ.png",o="/blog/assets/image-20220606151107556-D5exPWNr.png",u="/blog/assets/image-20220606152008870-Dj3Kzv1X.png",d={};function r(m,n){return p(),a("div",null,n[0]||(n[0]=[e(`<h1 id="练手" tabindex="-1"><a class="header-anchor" href="#练手"><span>练手</span></a></h1><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>en</span>
<span class="line">R1<span class="token comment">#conf t</span></span>
<span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static 172.16.16.1 64.100.50.1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>show run：</p><p><img src="`+i+`" alt="image-20220530151604470"></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int s0/0/0</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat outside</span></span>
<span class="line"></span>
<span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int g0/0</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat ins</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat inside </span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+t+'" alt="image-20220530151806406"></p><h1 id="nat-网络地址转换" tabindex="-1"><a class="header-anchor" href="#nat-网络地址转换"><span>NAT 网络地址转换</span></a></h1><h2 id="拓扑及ip配置" tabindex="-1"><a class="header-anchor" href="#拓扑及ip配置"><span>拓扑及IP配置</span></a></h2><p><img src="'+l+`" alt="image-20220606143533388"></p><h3 id="s0-fw" tabindex="-1"><a class="header-anchor" href="#s0-fw"><span>S0 (FW)</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">Router<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#host R0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int fa0/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 172.31.0.1 255.255.0.0 ?</span></span>
<span class="line">  <span class="token operator">&lt;</span>cr<span class="token operator">&gt;</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 172.31.0.1 255.255.0.0 </span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shut</span></span>
<span class="line"></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#</span></span>
<span class="line">%LINK-5-CHANGED: Interface FastEthernet0/0, changed state to up</span>
<span class="line"></span>
<span class="line">%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up</span>
<span class="line"></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int fa1/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 172.16.16.17 255.255.255.248</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shut</span></span>
<span class="line"></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#</span></span>
<span class="line">%LINK-5-CHANGED: Interface FastEthernet1/0, changed state to up</span>
<span class="line"></span>
<span class="line">%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet1/0, changed state to up</span>
<span class="line"></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int s2/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 202.96.128.85 255.255.255.248</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shut</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#clock rate 64000</span></span>
<span class="line"></span>
<span class="line">%LINK-5-CHANGED: Interface Serial2/0, changed state to down</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="s1-isp" tabindex="-1"><a class="header-anchor" href="#s1-isp"><span>S1 (ISP)</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">Router<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#host R1</span></span>
<span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int se2/0 </span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 202.96.128.86 255.255.255.248</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shut</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#clock rate 64000</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int fa0/0</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip add 10.10.10.9 255.255.255.252</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shut</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#</span></span>
<span class="line">%LINK-5-CHANGED: Interface FastEthernet0/0, changed state to up</span>
<span class="line"></span>
<span class="line">%LINEPROTO-5-UPDOWN: Line protocol on Interface FastEthernet0/0, changed state to up</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="静态nat配置" tabindex="-1"><a class="header-anchor" href="#静态nat配置"><span>静态NAT配置</span></a></h2><h3 id="s1-isp-1" tabindex="-1"><a class="header-anchor" href="#s1-isp-1"><span>S1 (ISP)</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int fa0/0</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat inside</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int s2/0</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat outside</span></span>
<span class="line">R1<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#exit</span></span>
<span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static 10.10.10.10 202.96.128.86</span></span>
<span class="line">R1<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>检测：</strong></p><p>从 S0 ping S1(202.96.128.86)，然后在 S1 show ip nat trasnslations</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R1<span class="token comment">#show ip nat translations </span></span>
<span class="line">Pro  Inside global     Inside <span class="token builtin class-name">local</span>       Outside <span class="token builtin class-name">local</span>      Outside global</span>
<span class="line">icmp <span class="token number">202.96</span>.128.86:1   <span class="token number">10.10</span>.10.10:1      <span class="token number">202.96</span>.128.85:1    <span class="token number">202.96</span>.128.85:1</span>
<span class="line">icmp <span class="token number">202.96</span>.128.86:2   <span class="token number">10.10</span>.10.10:2      <span class="token number">202.96</span>.128.85:2    <span class="token number">202.96</span>.128.85:2</span>
<span class="line">icmp <span class="token number">202.96</span>.128.86:3   <span class="token number">10.10</span>.10.10:3      <span class="token number">202.96</span>.128.85:3    <span class="token number">202.96</span>.128.85:3</span>
<span class="line">icmp <span class="token number">202.96</span>.128.86:4   <span class="token number">10.10</span>.10.10:4      <span class="token number">202.96</span>.128.85:4    <span class="token number">202.96</span>.128.85:4</span>
<span class="line">icmp <span class="token number">202.96</span>.128.86:5   <span class="token number">10.10</span>.10.10:5      <span class="token number">202.96</span>.128.85:5    <span class="token number">202.96</span>.128.85:5</span>
<span class="line">---  <span class="token number">202.96</span>.128.86     <span class="token number">10.10</span>.10.10        ---                ---</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+c+`" alt="image-20220606150311428"></p><h2 id="企业通过动态nat上网" tabindex="-1"><a class="header-anchor" href="#企业通过动态nat上网"><span>企业通过动态NAT上网</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#access-list 1 permit 172.31.0.0 0.0.255.255</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat pool ForInter 202.96.128.81 202.96.128.84 netmask 255.255.255.248</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source list 1 pool ForInter</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#int fa0/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat inside </span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int fa1/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat inside </span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#int s2/0</span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip nat outside </span></span>
<span class="line">R0<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>检测</strong></p><p>在 Laptop0 ping ISP(202.96.128.86) ，然后到 FW 中 show ip nat translations</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R0<span class="token comment">#show ip nat translations </span></span>
<span class="line">Pro  Inside global     Inside <span class="token builtin class-name">local</span>       Outside <span class="token builtin class-name">local</span>      Outside global</span>
<span class="line">icmp <span class="token number">202.96</span>.128.81:12  <span class="token number">172.31</span>.0.2:12      <span class="token number">202.96</span>.128.86:12   <span class="token number">202.96</span>.128.86:12</span>
<span class="line">icmp <span class="token number">202.96</span>.128.81:13  <span class="token number">172.31</span>.0.2:13      <span class="token number">202.96</span>.128.86:13   <span class="token number">202.96</span>.128.86:13</span>
<span class="line">icmp <span class="token number">202.96</span>.128.81:14  <span class="token number">172.31</span>.0.2:14      <span class="token number">202.96</span>.128.86:14   <span class="token number">202.96</span>.128.86:14</span>
<span class="line">icmp <span class="token number">202.96</span>.128.81:15  <span class="token number">172.31</span>.0.2:15      <span class="token number">202.96</span>.128.86:15   <span class="token number">202.96</span>.128.86:15</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+o+`" alt="image-20220606151107556"></p><h2 id="企业服务器的-pat端口转发" tabindex="-1"><a class="header-anchor" href="#企业服务器的-pat端口转发"><span>企业服务器的 PAT端口转发</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.18 80 202.96.128.85 80</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.18 443 202.96.128.85 443</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.18 8080 202.96.128.85 80</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static udp 172.16.16.18 53 202.96.128.85 53</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.21 21 202.96.128.85 21</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.21 20 202.96.128.85 20</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.22 25 202.96.128.85 25</span></span>
<span class="line">R0<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#ip nat inside source static tcp 172.16.16.22 110 202.96.128.85 110</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>检测</strong></p><p>从 Laptop0 使用各种服务访问 202.96.128.86， 然后到FW查看 ip nat translations</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">R0<span class="token comment">#show ip nat translations </span></span>
<span class="line">Pro  Inside global     Inside <span class="token builtin class-name">local</span>       Outside <span class="token builtin class-name">local</span>      Outside global</span>
<span class="line">udp <span class="token number">202.96</span>.128.85:53   <span class="token number">172.16</span>.16.18:53    ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.81:1028 <span class="token number">172.31</span>.0.2:1028    <span class="token number">202.96</span>.128.86:80   <span class="token number">202.96</span>.128.86:80</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:110  <span class="token number">172.16</span>.16.22:110   ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:20   <span class="token number">172.16</span>.16.21:20    ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:21   <span class="token number">172.16</span>.16.21:21    ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:25   <span class="token number">172.16</span>.16.22:25    ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:443  <span class="token number">172.16</span>.16.18:443   ---                ---</span>
<span class="line">tcp <span class="token number">202.96</span>.128.85:80   <span class="token number">172.16</span>.16.18:8080  ---                ---</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+u+'" alt="image-20220606152008870"></p>',32)]))}const v=s(d,[["render",r]]),b=JSON.parse('{"path":"/blogs/tech/networking/Cisco/Lab6_NAT.html","title":"Cisco 配置 NAT","lang":"en-US","frontmatter":{"title":"Cisco 配置 NAT","date":"2022-03-28T00:00:00.000Z","tags":["Networking","Cisco"],"categories":["tech"]},"headers":[{"level":2,"title":"拓扑及IP配置","slug":"拓扑及ip配置","link":"#拓扑及ip配置","children":[{"level":3,"title":"S0 (FW)","slug":"s0-fw","link":"#s0-fw","children":[]},{"level":3,"title":"S1 (ISP)","slug":"s1-isp","link":"#s1-isp","children":[]}]},{"level":2,"title":"静态NAT配置","slug":"静态nat配置","link":"#静态nat配置","children":[{"level":3,"title":"S1 (ISP)","slug":"s1-isp-1","link":"#s1-isp-1","children":[]}]},{"level":2,"title":"企业通过动态NAT上网","slug":"企业通过动态nat上网","link":"#企业通过动态nat上网","children":[]},{"level":2,"title":"企业服务器的 PAT端口转发","slug":"企业服务器的-pat端口转发","link":"#企业服务器的-pat端口转发","children":[]}],"git":{"createdTime":1766826955000,"updatedTime":1766890838000,"contributors":[{"name":"PPPerryPan","email":"perrypan0123@outlook.com","commits":2}]},"filePathRelative":"blogs/tech/networking/Cisco/Lab6_NAT.md"}');export{v as comp,b as data};
