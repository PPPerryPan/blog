import{_ as t,c as l,b as e,a,d as i,e as p,r,o as c}from"./app-CUDFWA7u.js";const o="/blog/assets/image-20220927170016317-D3aB94Td.png",d="/blog/assets/image-20220927170333892--AUh9JWL.png",h="/blog/assets/image-20220927170420328-C7megohh.png",g="/blog/assets/image-20220927171017800-iuDg4ilF.png",m="/blog/assets/image-20220927171258367-Ddr1ml4p.png",u="/blog/assets/image-20220927171700417-BQuCQXOL.png",x="/blog/assets/image-20220927171920200-ZN3YX2mb.png",v="/blog/assets/image-20220927172029169-D6ul6Gxc.png",b="/blog/assets/image-20220927184241081-BquslTTW.png",k="/blog/assets/image-20220927184725453-CLHpMMXP.png",_="/blog/assets/image-20220927185439103-FAvl3JR_.png",f="/blog/assets/image-20220927185155986-CVliSsr1.png",q="/blog/assets/image-20220927185300666-BhgcwOtW.png",j="/blog/assets/image-20220927185417986-CJGJWMtZ.png",S="/blog/assets/image-20220927185538470-DFHeswcp.png",y="/blog/assets/image-20220927185605206-BMraABqh.png",C="/blog/assets/image-20220927185629341-DEvFtqks.png",X="/blog/assets/image-20220927185735383-iEE40zmP.png",L="/blog/assets/image-20220927190636632-CzZ5L1wg.png",M="/blog/assets/image-20220927191915582-nfk1Nv8I.png",P="/blog/assets/image-20220927192603451-By3psFNu.png",B="/blog/assets/image-20220927192508213-lTg5Tvqk.png",D="/blog/assets/image-20220927192839669-Dr2lO9Nt.png",T="/blog/assets/image-20220927192916024-CNQkitp_.png",w="/blog/assets/image-20220927193331347-CMA5aZzo.png",N="/blog/assets/image-20220927194116269-BGZlyEQV.png",J="/blog/assets/image-20220927193808755-Ci-ir79e.png",O={},E={id:"定义和用法",tabindex:"-1"},R={class:"header-anchor",href:"#定义和用法"},U={href:"https://www.w3school.com.cn/tags/att_a_href.asp",target:"_blank",rel:"noopener noreferrer"};function V(Z,s){const n=r("ExternalLinkIcon");return c(),l("div",null,[s[3]||(s[3]=e('<h1 id="xss" tabindex="-1"><a class="header-anchor" href="#xss"><span>XSS</span></a></h1><h2 id="反射型xss-get" tabindex="-1"><a class="header-anchor" href="#反射型xss-get"><span>反射型xss(get)</span></a></h2><h3 id="分析" tabindex="-1"><a class="header-anchor" href="#分析"><span>分析</span></a></h3><p>先随便输入试试 <code>&lt;script&gt;alert(&quot;123&quot;)&lt;/script&gt;</code></p><p>发现输不完，前端限制了输入长度</p><p><img src="'+o+'" alt="image-20220927170016317"></p><h3 id="利用" tabindex="-1"><a class="header-anchor" href="#利用"><span>利用</span></a></h3><p>maxlength 改大点即可</p><p><img src="'+d+'" alt="image-20220927170333892"></p><p>当然，也可以直接改URL，Messenger字段改成 <code>&lt;script&gt;alert(&quot;123&quot;)&lt;/script&gt;</code> 即可（如上图）</p><p><img src="'+h+'" alt="image-20220927170420328"></p><h2 id="反射性xss-post" tabindex="-1"><a class="header-anchor" href="#反射性xss-post"><span>反射性xss(post)</span></a></h2><h3 id="分析-1" tabindex="-1"><a class="header-anchor" href="#分析-1"><span>分析</span></a></h3><p>开始还以为漏洞就在登录框里，看了下提示，好吧原来是要先登录进去</p><p><img src="'+g+'" alt="image-20220927171017800"></p><h3 id="利用-1" tabindex="-1"><a class="header-anchor" href="#利用-1"><span>利用</span></a></h3><p>根据提示，要求 XSS 获取 Cookie，那就： <code>&lt;script&gt;alert( &quot;Cookie:\\n&quot; + document.cookie)&lt;/script&gt;</code></p><p><img src="'+m+'" alt="image-20220927171258367"></p><h2 id="存储型xss" tabindex="-1"><a class="header-anchor" href="#存储型xss"><span>存储型xss</span></a></h2><h3 id="分析-2" tabindex="-1"><a class="header-anchor" href="#分析-2"><span>分析</span></a></h3><p>一样的道理，不过存储型 XSS 的危害相对更大，每次页面加载或刷新都会被执行，且其他用户访问也会。</p><h3 id="利用-2" tabindex="-1"><a class="header-anchor" href="#利用-2"><span>利用</span></a></h3><p><code>&lt;script&gt;alert( &quot;Cookie:\\n&quot; + document.cookie)&lt;/script&gt;</code></p><p><img src="'+u+'" alt="image-20220927171700417"></p><h2 id="dom型xss" tabindex="-1"><a class="header-anchor" href="#dom型xss"><span>DOM型xss</span></a></h2><h3 id="分析-3" tabindex="-1"><a class="header-anchor" href="#分析-3"><span>分析</span></a></h3><p>先弹个123试试 <code>&lt;script&gt;alert(&quot;123&quot;)&lt;/script&gt;</code>，不行：</p><p><img src="'+x+'" alt="image-20220927171920200"></p><p>查看源代码，发现a标签拼接。</p><p><img src="'+v+`" alt="image-20220927172029169"></p><h3 id="利用-3" tabindex="-1"><a class="header-anchor" href="#利用-3"><span>利用</span></a></h3><p>把a标签闭合掉即可，同时可以利用 img 标签进行XSS</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line">&#39; onclick=&quot;alert(&#39;123&#39;)&quot;&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">// a href=&#39;&quot;+str+&quot;&#39;</span>
<span class="line">// a href=&#39;&#39; onclick=&quot;alert(&#39;123&#39;)&quot;&gt;&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>提交后点击 what do you see，成功alert</p><p><img src="`+b+`" alt="image-20220927184241081"></p><h2 id="dom型xss-x" tabindex="-1"><a class="header-anchor" href="#dom型xss-x"><span>DOM型xss-x</span></a></h2><h3 id="利用-4" tabindex="-1"><a class="header-anchor" href="#利用-4"><span>利用</span></a></h3><p>与上面同理</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line">&#39; onclick=&quot;alert(&#39;123&#39;)&quot;&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+k+'" alt="image-20220927184725453"></p><h2 id="xss盲打" tabindex="-1"><a class="header-anchor" href="#xss盲打"><span>xss盲打</span></a></h2><h3 id="分析-4" tabindex="-1"><a class="header-anchor" href="#分析-4"><span>分析</span></a></h3><p>先随便提交点东西，发现没什么变化</p><p><img src="'+_+'" alt="image-20220927185439103"></p><p>看一下源代码，发现提交方式是post</p><p><img src="'+f+'" alt="image-20220927185155986"></p><p>按照提示登陆后台</p><p><img src="'+q+'" alt="image-20220927185300666"></p><p>发现刚才提交的数据</p><p><img src="'+j+'" alt="image-20220927185417986"></p><h3 id="利用-5" tabindex="-1"><a class="header-anchor" href="#利用-5"><span>利用</span></a></h3><p>回去试一下 <code>&lt;script&gt;alert(&quot;123&quot;)&lt;/script&gt;</code></p><p><img src="'+S+'" alt="image-20220927185538470"></p><p>然后登陆后台</p><p><img src="'+y+'" alt="image-20220927185605206"></p><p>两个 XSS 都正常执行</p><p><img src="'+C+'" alt="image-20220927185629341"></p><h2 id="xss之过滤" tabindex="-1"><a class="header-anchor" href="#xss之过滤"><span>xss之过滤</span></a></h2><h3 id="分析-5" tabindex="-1"><a class="header-anchor" href="#分析-5"><span>分析</span></a></h3><p>先随便提交点数据看看</p><p><img src="'+X+'" alt="image-20220927185735383"></p><p>猜测一下会被过滤的内容：&quot; &lt; &gt; &#39; on / ` () script img src href</p><p>直接整段提交：</p><p><img src="'+L+`" alt="image-20220927190636632"></p><p>感觉可以用 img οnerrοr</p><h3 id="利用-6" tabindex="-1"><a class="header-anchor" href="#利用-6"><span>利用</span></a></h3><p>构造Payload：</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onerror</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token value javascript language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span></span></span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+M+`" alt="image-20220927191915582"></p><h2 id="xss之htmlspecialchars" tabindex="-1"><a class="header-anchor" href="#xss之htmlspecialchars"><span>xss之htmlspecialchars</span></a></h2><h3 id="分析-6" tabindex="-1"><a class="header-anchor" href="#分析-6"><span>分析</span></a></h3><p>htmlspecialchars() 函数把一些预定义的字符转换为HTML 实体。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">被转换的预定义的字符有：</span>
<span class="line">&amp;：转换为&amp;amp;</span>
<span class="line">&quot;：转换为&amp;quot;</span>
<span class="line">&#39;：转换为成为 &#39;</span>
<span class="line">&lt;：转换为&amp;lt;</span>
<span class="line">&gt;：转换为&amp;gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>单引号没有被转换</p><h3 id="利用-7" tabindex="-1"><a class="header-anchor" href="#利用-7"><span>利用</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">#&#39; onclick=&#39;alert(123)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+P+'" alt="image-20220927192603451"></p><p><img src="'+B+'" alt="image-20220927192508213"></p><h2 id="xss之href输出" tabindex="-1"><a class="header-anchor" href="#xss之href输出"><span>xss之href输出</span></a></h2><h3 id="分析-7" tabindex="-1"><a class="header-anchor" href="#分析-7"><span>分析</span></a></h3><p>随便输个alert，点也不生效</p><p><img src="'+D+'" alt="image-20220927192839669"></p><p>看一下源码，都被HTML编码了</p><p><img src="'+T+'" alt="image-20220927192916024"></p><p>看一下提示，查一下a标签的href属性：</p>',86)),a("blockquote",null,[a("h2",E,[a("a",R,[a("span",null,[a("a",U,[s[0]||(s[0]=i("定义和用法")),p(n)])])])]),s[1]||(s[1]=a("p",null,"<a> 标签的 href 属性用于指定超链接目标的 URL。",-1)),s[2]||(s[2]=a("p",null,"href 属性的值可以是任何有效文档的相对或绝对 URL，包括片段标识符和 JavaScript 代码段。如果用户选择了 <a> 标签中的内容，那么浏览器会尝试检索并显示 href 属性指定的 URL 所表示的文档，或者执行 JavaScript 表达式、方法和函数的列表",-1))]),s[4]||(s[4]=e(`<p>注意最后一句 “或者执行JS表达式......”</p><h3 id="利用-8" tabindex="-1"><a class="header-anchor" href="#利用-8"><span>利用</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token literal-property property">javascript</span><span class="token operator">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+w+'" alt="image-20220927193331347"></p><h2 id="xss之js输出" tabindex="-1"><a class="header-anchor" href="#xss之js输出"><span>xss之js输出</span></a></h2><h3 id="分析-8" tabindex="-1"><a class="header-anchor" href="#分析-8"><span>分析</span></a></h3><p>先试试上面的 <code>javascript:alert(&quot;123&quot;)</code>，无效，看源代码，被包进变量里了</p><p><img src="'+N+`" alt="image-20220927194116269"></p><p>可以直接闭合掉来利用</p><h3 id="利用-9" tabindex="-1"><a class="header-anchor" href="#利用-9"><span>利用</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">闭合你&#39;<span class="token punctuation">;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注释你</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>组合后就只剩下中间的 alert 了：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line">$ms<span class="token operator">=</span><span class="token string">&#39;闭合你&#39;</span><span class="token punctuation">;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 注释你&#39;;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+J+'" alt="image-20220927193808755"></p>',14))])}const W=t(O,[["render",V]]),A=JSON.parse('{"path":"/blogs/tech/security/web/Pikachu/02_XSS.html","title":"PiKachu - XSS","lang":"en-US","frontmatter":{"title":"PiKachu - XSS","date":"2022-09-27T00:00:00.000Z","tags":["Web","security"],"categories":["tech"]},"headers":[{"level":2,"title":"反射型xss(get)","slug":"反射型xss-get","link":"#反射型xss-get","children":[{"level":3,"title":"分析","slug":"分析","link":"#分析","children":[]},{"level":3,"title":"利用","slug":"利用","link":"#利用","children":[]}]},{"level":2,"title":"反射性xss(post)","slug":"反射性xss-post","link":"#反射性xss-post","children":[{"level":3,"title":"分析","slug":"分析-1","link":"#分析-1","children":[]},{"level":3,"title":"利用","slug":"利用-1","link":"#利用-1","children":[]}]},{"level":2,"title":"存储型xss","slug":"存储型xss","link":"#存储型xss","children":[{"level":3,"title":"分析","slug":"分析-2","link":"#分析-2","children":[]},{"level":3,"title":"利用","slug":"利用-2","link":"#利用-2","children":[]}]},{"level":2,"title":"DOM型xss","slug":"dom型xss","link":"#dom型xss","children":[{"level":3,"title":"分析","slug":"分析-3","link":"#分析-3","children":[]},{"level":3,"title":"利用","slug":"利用-3","link":"#利用-3","children":[]}]},{"level":2,"title":"DOM型xss-x","slug":"dom型xss-x","link":"#dom型xss-x","children":[{"level":3,"title":"利用","slug":"利用-4","link":"#利用-4","children":[]}]},{"level":2,"title":"xss盲打","slug":"xss盲打","link":"#xss盲打","children":[{"level":3,"title":"分析","slug":"分析-4","link":"#分析-4","children":[]},{"level":3,"title":"利用","slug":"利用-5","link":"#利用-5","children":[]}]},{"level":2,"title":"xss之过滤","slug":"xss之过滤","link":"#xss之过滤","children":[{"level":3,"title":"分析","slug":"分析-5","link":"#分析-5","children":[]},{"level":3,"title":"利用","slug":"利用-6","link":"#利用-6","children":[]}]},{"level":2,"title":"xss之htmlspecialchars","slug":"xss之htmlspecialchars","link":"#xss之htmlspecialchars","children":[{"level":3,"title":"分析","slug":"分析-6","link":"#分析-6","children":[]},{"level":3,"title":"利用","slug":"利用-7","link":"#利用-7","children":[]}]},{"level":2,"title":"xss之href输出","slug":"xss之href输出","link":"#xss之href输出","children":[{"level":3,"title":"分析","slug":"分析-7","link":"#分析-7","children":[]},{"level":3,"title":"利用","slug":"利用-8","link":"#利用-8","children":[]}]},{"level":2,"title":"xss之js输出","slug":"xss之js输出","link":"#xss之js输出","children":[{"level":3,"title":"分析","slug":"分析-8","link":"#分析-8","children":[]},{"level":3,"title":"利用","slug":"利用-9","link":"#利用-9","children":[]}]}],"git":{"createdTime":1766928673000,"updatedTime":1766928673000,"contributors":[{"name":"PPPerryPan","email":"perrypan0123@outlook.com","commits":1}]},"filePathRelative":"blogs/tech/security/web/Pikachu/02_XSS.md"}');export{W as comp,A as data};
